# ç›®å½•
[English version](./api.en-US.md) 

- [WebSocketCrossServerAdapter](#websocketcrossserveradapter)
  - [Constructor(options)](#constructoroptions)
  - [onCrossServerEvent(event, listener, tag)](#oncrossservereventevent-listener-tag)
  - [onceCrossServerEvent(event, listener, tag)](#oncecrossservereventevent-listener-tag)
  - [offCrossServerEvent(event, listenerOrTag)](#offcrossservereventevent-listenerortag)
  - [publishRedisMessage(channel, message)](#publishredismessagechannel-message)
  - [emitCrossServer(event, message, callback, options)](#emitcrossserverevent-message-callback-options)
  - [emitCrossServerWithPromise(event, message, options)](#emitcrossserverwithpromiseevent-message-options)
  - [deleteCrossServerCallback(callbackId)](#deletecrossservercallbackcallbackid)
  - [manualSubscribe(channel)](#manualsubscribechannel)
  - [manualUnsubscribe(channel)](#manualunsubscribechannel)
  - [setCustomChannelHandler(handler)](#setcustomchannelhandlerhandler)
  - [removeCustomChannelHandler()](#removecustomchannelhandler)
  - [addRedisInstance(config)](#addredisinstanceconfig)
  - [getHealthyRedisInstancesCount(type)](#gethealthyredisinstancescounttype)
  - [getRedisInstancesCount()](#getredisinstancescount)
  - [onWebSocketEvent(event, listener, tag)](#onwebsocketeventevent-listener-tag)
     - [ç³»ç»Ÿå†…ç½® WebSocket äº‹ä»¶è¯´æ˜](#ç³»ç»Ÿå†…ç½®-websocket-äº‹ä»¶è¯´æ˜)
  - [onceWebSocketEvent(event, listener, tag)](#oncewebsocketeventevent-listener-tag)
  - [offWebSocketEvent(event, listenerOrTag)](#offwebsocketeventevent-listenerortag)
  - [broadcastToRoom(roomNamespace, roomId, event, data, options)](#broadcasttoroomroomnamespace-roomid-event-data-options)
  - [toSocketId(socketId, event, data)](#tosocketidsocketid-event-data)
  - [toSocketIds(socketIds, event, data)](#tosocketidssocketids-event-data)
  - [broadcast(event, data, localOnly)](#broadcastevent-data-localonly)
  - [joinRoom(roomNamespace, roomId, socketId)](#joinroomroomnamespace-roomid-socketid)
  - [leaveRoom(roomNamespace, roomId, socketId)](#leaveroomroomnamespace-roomid-socketid)
  - [removeRoom(roomNamespace,roomId)](#removeroomroomnamespace-roomid)
  - [getSocketCountInRoom(roomNamespace, roomId, options)](#getsocketcountinroomroomnamespace-roomid-options)
  - [getRoomSocketIds(roomNamespace, roomId, options)](#getroomsocketidsroomnamespace-roomid-options)
  - [getJoinedRooms(socketId, roomNamespace)](#getjoinedroomssocketid-roomnamespace)
  - [isJoinedRoom(socketId, roomNamespace, roomId)](#isjoinedroomsocketid-roomnamespace-roomid)
  - [getRoomCount(roomNamespace, options)](#getroomcountroomnamespace-options)
  - [getRoomIds(roomNamespace, options)](#getroomidsroomnamespace-options)
  - [setUserSocket(socketId, socket)](#setusersocketsocketid-socket)
  - [removeUserSocket(socketId)](#removeusersocketsocketid)
  - [getSocketInstance(socketId)](#getsocketinstancesocketid)
  - [getSocketClientCount()](#getsocketclientcount)
  - [getServerName()](#getservername)
  - [getWss()](#getwss)
  - [parseWsRequestParams(req, options)](#parsewsrequestparamsreq-options)

- [WebSocketConnector](#websocketconnector)
  - [constructor(options)](#constructoroptions-1)
  - [on(event, listener, tag)](#onevent-listener-tag)
  - [once(event, listener, tag)](#onceevent-listener-tag)
  - [off(event, listenerOrTag)](#offevent-listenerortag)
  - [emit(event, data, callback, options)](#emitevent-data-callback-options)
  - [emitWithPromise(event, data, options)](#emitwithpromiseevent-data-options)
  - [reconnect(repeatReset)](#reconnectrepeatReset)
  - [reconnecting()](#reconnecting)
  - [setPingInterval(newInterval, immediate)](#setpingintervalnewinterval-immediate)
  - [getPingInterval()](#getpinginterval)
  - [manualClose()](#manualClose)
  - [Events](#events)

# WebSocketCrossServerAdapter

## Constructor(options)

### æè¿°  
`WebSocketCrossServerAdapter` çš„æ„é€ å‡½æ•°ã€‚ç”¨äºåˆå§‹åŒ–ä¸€ä¸ª WebSocket è·¨æœåŠ¡å™¨é€šä¿¡é€‚é…å™¨ï¼Œå¹¶å¯æä¾›å¤šç§é…ç½®é€‰é¡¹ã€‚

### å‚æ•°è¯´æ˜

- `options` `{Object}`ï¼šé€‚é…å™¨çš„é…ç½®å¯¹è±¡ã€‚

  - `serverName` `{string}`ï¼šï¼ˆå¿…å¡«ï¼‰å½“å‰æœåŠ¡å™¨èŠ‚ç‚¹çš„ **å…¨å±€å”¯ä¸€æ ‡è¯†ç¬¦**ï¼Œç”¨äºè·¨æœåŠ¡å™¨é€šä¿¡å’Œå›è°ƒ ID ç”Ÿæˆã€‚

    ç¤ºä¾‹å€¼åŒ…æ‹¬ `"us-east-1-node3"` æˆ– `"game-server-42"`ã€‚

    ### è¯´æ˜

    - å¿…é¡»ä¿è¯åœ¨æ‰€æœ‰æœåŠ¡å™¨èŠ‚ç‚¹é—´å”¯ä¸€ã€‚
    - å»ºè®®é•¿åº¦ä¸è¶…è¿‡ **16** ä¸ªå­—ç¬¦ï¼Œé¿å…è¿‡é•¿å¢åŠ é€šä¿¡è´Ÿæ‹…ã€‚
    - `serverName` ä¼šéšè·¨æœåŠ¡å™¨æ¶ˆæ¯å‘é€ï¼Œè¿‡é•¿ä¼šå½±å“é€šä¿¡æ€§èƒ½ã€‚

  - `bridgePrefix` `{string}`ï¼šï¼ˆå¯é€‰ï¼‰è·¨æœåŠ¡å™¨æ¡¥æ¥é¢‘é“å‰ç¼€ï¼Œé»˜è®¤å€¼ä¸º `'csbp:'`ã€‚

    **è¯´æ˜**ï¼š  
    æ­¤å‰ç¼€ç”¨äºæ ‡è¯†æ‰€æœ‰è·¨æœåŠ¡æ¶ˆæ¯çš„ Redis é¢‘é“ï¼Œæ‰€æœ‰è·¨æœåŠ¡å™¨é€šä¿¡éƒ½ä¼šä½¿ç”¨å¸¦æœ‰æ­¤å‰ç¼€çš„é¢‘é“ã€‚  
    å®ƒæ˜¯åŒºåˆ†è·¨æœåŠ¡å™¨æ¶ˆæ¯å’Œå…¶ä»–æ¶ˆæ¯çš„å…³é”®æ ‡è¯†ï¼Œå¿…é¡»åœ¨æ‰€æœ‰æœåŠ¡å™¨èŠ‚ç‚¹ä¹‹é—´ä¿æŒä¸€è‡´ä¸”å”¯ä¸€ã€‚  
    æ³¨æ„ï¼š**æ­¤å€¼å¿…é¡»ä¸ `wsPrefix` ä¸åŒ**ï¼Œå¦åˆ™ä¼šå¯¼è‡´æ¶ˆæ¯å†²çªå’Œå¤„ç†æ··ä¹±ã€‚

  - `wsPrefix` `{string}`ï¼šï¼ˆå¯é€‰ï¼‰WebSocket é¢‘é“å‰ç¼€ï¼Œé»˜è®¤å€¼ä¸º `'ws:'`ã€‚

    **è¯´æ˜**ï¼š  
    æ­¤å‰ç¼€ç”¨äºæ ‡è®° WebSocket è·¯ç”±é¢‘é“çš„ Redis é¢‘é“ï¼Œä¸“é—¨ç”¨äºç®¡ç†å®¢æˆ·ç«¯è¿æ¥çš„æˆ¿é—´æ¶ˆæ¯ã€‚  
    å…¶ä½œç”¨æ˜¯åŒºåˆ†æ™®é€šçš„è·¨æœæ¡¥æ¥æ¶ˆæ¯ï¼ˆ`bridgePrefix`ï¼‰å’ŒåŸºäº WebSocket çš„æˆ¿é—´é€šä¿¡æ¶ˆæ¯ã€‚  
    åŒæ ·ï¼Œ**æ­¤å€¼å¿…é¡»ä¸ `bridgePrefix` ä¸åŒ**ï¼Œç¡®ä¿ä¸¤ç±»æ¶ˆæ¯åœ¨ Redis é¢‘é“ä¸Šä¸ä¼šæ··æ·†ã€‚

    âš ï¸ **é‡è¦è¯´æ˜**ï¼š  
    `bridgePrefix` å’Œ `wsPrefix` è¿™ä¸¤ä¸ªå‰ç¼€ä¸èƒ½ç›¸åŒã€‚  
    å¦‚æœä¸¤ä¸ªå‰ç¼€è®¾ç½®æˆç›¸åŒå€¼ï¼Œä¼šå¯¼è‡´è·¨æœåŠ¡å™¨æ¶ˆæ¯å’Œ WebSocket æˆ¿é—´æ¶ˆæ¯æ··æ·†ï¼Œå¯èƒ½é€ æˆé€šä¿¡é”™è¯¯å’Œæ•°æ®ä¸¢å¤±ã€‚


  - `wsOptions` `{Object}`ï¼šï¼ˆå¯é€‰ï¼‰WebSocket æœåŠ¡çš„é…ç½®é€‰é¡¹ã€‚å¦‚æœä¸ä¼ è¯¥å‚æ•°ï¼Œè¡¨ç¤º**ä¸ä¼šå¯åŠ¨ WebSocket æœåŠ¡**ã€‚

    **è¯´æ˜**ï¼šæ­¤å¯¹è±¡åŒ…å« WebSocket æœåŠ¡çš„æ‰€æœ‰é…ç½®é¡¹ã€‚æ‰€æœ‰ä¸ WebSocket ç›¸å…³çš„é…ç½®è¯·æ”¾å…¥æ­¤å¯¹è±¡ä¸­ã€‚æ›´å¤šç»†èŠ‚è¯·å‚è€ƒ [ws å®˜æ–¹æ–‡æ¡£](https://github.com/websockets/ws?tab=readme-ov-file)ã€‚

    **å¸¸è§é…ç½®é¡¹**ï¼š

    - `noServer` `{boolean}`ï¼šæ˜¯å¦ä½¿ç”¨ `noServer` æ¨¡å¼ï¼Œé»˜è®¤å€¼ä¸º `false`ã€‚
    - `server` `{Object}`ï¼šå¤–éƒ¨æä¾›çš„ HTTP/HTTPS æœåŠ¡å®ä¾‹ã€‚
    - `port` `{number}`ï¼šWebSocket æœåŠ¡ç›‘å¬ç«¯å£ã€‚

  - `serverPingInterval` `{number}`ï¼šï¼ˆå¯é€‰ï¼‰**æœåŠ¡å™¨å‘æ‰€æœ‰å·²è¿æ¥å®¢æˆ·ç«¯å‘é€ WebSocket åè®®å±‚çº§ `ping` å¸§çš„æ—¶é—´é—´éš”**ï¼Œé»˜è®¤å€¼ä¸º `20000`ã€‚

    **è¯´æ˜**ï¼š  
    æ­¤å‚æ•°æ§åˆ¶æœåŠ¡å™¨æ¯éš”å¤šå°‘æ¯«ç§’å‘é€ä¸€æ¬¡åº•å±‚ WebSocket `ping` å¸§ç»™å®¢æˆ·ç«¯ã€‚  
    è¿™å¹¶éåº”ç”¨å±‚å¿ƒè·³ï¼Œè€Œæ˜¯ WebSocket åè®®æœ¬èº«æä¾›çš„æœºåˆ¶ï¼Œç”¨äºæ£€æµ‹æ–­å¼€çš„ TCP è¿æ¥ã€‚  
    å®¢æˆ·ç«¯æ¥æ”¶åˆ° `ping` å¸§åä¼šè‡ªåŠ¨å›åº”ä¸€ä¸ª `pong` å¸§ï¼›è‹¥è¿æ¥å·²ä¸­æ–­ï¼ŒæœåŠ¡å™¨æ— æ³•æ”¶åˆ° `pong`ï¼Œä¾¿å¯æ®æ­¤å…³é—­è¯¥è¿æ¥ã€‚

    âš ï¸ **æ³¨æ„**ï¼šè¯·å‹¿ä¸åº”ç”¨å±‚å®ç°çš„å¿ƒè·³æœºåˆ¶æ··æ·†ï¼ˆä¾‹å¦‚å­—ç¬¦ä¸² `"ping"`ï¼‰ã€‚  
    åº”ç”¨å±‚å¿ƒè·³é€šå¸¸ç”±å®¢æˆ·ç«¯ä¸»åŠ¨å‘èµ·ï¼Œç”¨äºæ£€æµ‹é€»è¾‘å±‚çš„è¿æ¥çŠ¶æ€ã€‚

  - `enterBackgroundCloseTime` `{number}`ï¼šï¼ˆå¯é€‰ï¼‰å®¢æˆ·ç«¯è¿›å…¥åå°åå¼ºåˆ¶å…³é—­ WebSocket è¿æ¥çš„è¶…æ—¶æ—¶é—´ï¼Œå•ä½ä¸ºæ¯«ç§’ï¼Œé»˜è®¤å€¼ä¸º `10000`ï¼ˆ10 ç§’ï¼‰ã€‚

    **è¯´æ˜**ï¼š  
    æ­¤å‚æ•°ç”¨äºæ§åˆ¶å®¢æˆ·ç«¯è¿›å…¥åå°æ¨¡å¼åï¼ŒæœåŠ¡å™¨ç­‰å¾…å¤šä¹…å†ä¸»åŠ¨æ–­å¼€è¿æ¥ã€‚  
    åœ¨ iOS å’Œ Android å¹³å°ä¸Šï¼Œåå°çŠ¶æ€çš„å¤„ç†æ–¹å¼ä¸åŒï¼Œå®¢æˆ·ç«¯å¯é€šè¿‡äº‹ä»¶ç›‘å¬åœ¨è¿›å…¥åå°æ—¶å°†æ—¶é—´æˆ³é€šçŸ¥æœåŠ¡å™¨ã€‚  
    è‹¥å®¢æˆ·ç«¯ä¿æŒåå°çŠ¶æ€è¶…è¿‡è¯¥æ—¶é—´ï¼ŒæœåŠ¡å™¨å¯ä¸»åŠ¨æ–­å¼€è¿æ¥ã€‚  
    å¦‚æœä¸éœ€è¦æ­¤åŠŸèƒ½ï¼Œå®¢æˆ·ç«¯æ— éœ€å‘é€è¿›å…¥åå°çš„é€šçŸ¥å³å¯ã€‚

  - `heartbeatStr` `{string}`ï¼šï¼ˆå¯é€‰ï¼‰å¿ƒè·³å­—ç¬¦ä¸²ï¼Œé»˜è®¤å€¼ä¸º `''`ï¼ˆç©ºå­—ç¬¦ä¸²ï¼‰ã€‚

    **è¯´æ˜**ï¼š  
    æ­¤å€¼ä¸ºæœåŠ¡å™¨ç”¨äºè¯†åˆ«å®¢æˆ·ç«¯å¿ƒè·³åŒ…çš„å­—ç¬¦ä¸²ã€‚  
    å¿…é¡»ä¸å®¢æˆ·ç«¯å‘é€çš„å¿ƒè·³åŒ…å†…å®¹ä¸€è‡´ï¼ˆå¦‚é€šè¿‡ `WebSocketConnector` ç±»å‘é€ï¼‰ã€‚  
    å½“æœåŠ¡å™¨æ”¶åˆ°è¯¥å­—ç¬¦ä¸²çš„æ¶ˆæ¯æ—¶ï¼Œä¼šä½¿ç”¨ç›¸åŒå†…å®¹è¿›è¡Œå›åº”ï¼Œä½œä¸ºå¿ƒè·³å“åº”ã€‚

  - `redisForcePing` `{boolean}`ï¼šï¼ˆå¯é€‰ï¼‰æ˜¯å¦å¼ºåˆ¶å¯ç”¨ Redis å¥åº·æ£€æŸ¥ï¼Œé»˜è®¤å€¼ä¸º `true`ã€‚

  - `redisPingInterval` `{number}`ï¼šï¼ˆå¯é€‰ï¼‰Redis å¥åº·æ£€æŸ¥çš„å‘é€é—´éš”ï¼Œé»˜è®¤å€¼ä¸º `5000`ã€‚

  - `redisPingTimeout` `{number}`ï¼šï¼ˆå¯é€‰ï¼‰Redis å¥åº·æ£€æŸ¥è¶…æ—¶æ—¶é—´ï¼Œé»˜è®¤å€¼ä¸º `2000`ã€‚

  - `selectionStrategy` `{string}`ï¼šï¼ˆå¯é€‰ï¼‰Redis èŠ‚ç‚¹é€‰æ‹©ç­–ç•¥ï¼Œé»˜è®¤å€¼ä¸º `'random'`ï¼Œå¯é€‰å€¼æœ‰ `'random'`ã€`'round-robin'`ã€`'fastest'`ã€‚

  - `enableRedisDataCompression` `{boolean}`ï¼šï¼ˆå¯é€‰ï¼‰æ˜¯å¦å¯ç”¨ Redis æ•°æ®å‹ç¼©ï¼Œé»˜è®¤å€¼ä¸º `true`ã€‚

  - `onRedisHealthChange` `{function}`ï¼šï¼ˆå¯é€‰ï¼‰Redis å¥åº·çŠ¶æ€å˜æ›´æ—¶çš„å›è°ƒå‡½æ•°ã€‚

  - `onRedisSubscriptionError` `{function}`ï¼šï¼ˆå¯é€‰ï¼‰Redis è®¢é˜…å¤±è´¥æ—¶çš„å›è°ƒå‡½æ•°ã€‚

  - `presetRoomNamespaces` `{Array<string>}`ï¼šï¼ˆå¯é€‰ï¼‰é¢„å®šä¹‰çš„ WebSocket æˆ¿é—´å‘½åç©ºé—´ã€‚

    **è¯´æ˜**ï¼š  
    å¼€å‘è€…å¯é¢„è®¾ä¸€ç»„å‘½åç©ºé—´ï¼Œå¦‚ `"chat"`ã€`"game"`ã€`"group"` ç­‰ã€‚  
    è¿™äº›å‘½åç©ºé—´åœ¨ Redis åˆå§‹åŒ–æ—¶å°† **è‡ªåŠ¨è®¢é˜…å¯¹åº”çš„ Redis é¢‘é“**ã€‚  
    ä½ ä¹Ÿå¯ä»¥ä¸é¢„è®¾ï¼Œè€Œæ˜¯åœ¨å®¢æˆ·ç«¯é€šè¿‡ `joinRoom` åŠ¨æ€åŠ å…¥æˆ¿é—´æ—¶å†è®¢é˜…å¯¹åº”é¢‘é“ã€‚  
    å‘½åç©ºé—´çš„è®¾è®¡åº”ç»“åˆä¸šåŠ¡é€»è¾‘åŠæˆ¿é—´åˆ†ç±»ç­–ç•¥è¿›è¡Œã€‚
  
  - `autoUnsubscribe` `{boolean}`ï¼šï¼ˆå¯é€‰ï¼‰å½“æŸä¸ªæˆ¿é—´å‘½åç©ºé—´å†…æ²¡æœ‰ä»»ä½•å®¢æˆ·ç«¯æ—¶ï¼Œæ˜¯å¦è‡ªåŠ¨å–æ¶ˆè®¢é˜…è¯¥ Redis é¢‘é“ï¼Œé»˜è®¤å€¼ä¸º `true`ã€‚
  
    æ­¤è®¾ç½®ä»…é’ˆå¯¹éé¢„è®¾ï¼ˆé `presetRoomNamespaces` ä¸­åˆ—å‡ºçš„ï¼‰æˆ¿é—´å‘½åç©ºé—´ç”Ÿæ•ˆã€‚  
    é¢„è®¾æˆ¿é—´ä¸ä¼šå—æ­¤å½±å“ï¼Œå§‹ç»ˆä¿æŒè®¢é˜…çŠ¶æ€ã€‚

  - `customChannels` `{Array<string>|string}`ï¼šï¼ˆå¯é€‰ï¼‰è‡ªå®šä¹‰ Redis é¢‘é“ã€‚

    **è¯´æ˜**ï¼š  
    ä¸€ç»„å¼€å‘è€…è‡ªå®šä¹‰çš„ Redis é¢‘é“åç§°ã€‚  
    è¿™äº›é¢‘é“åœ¨ Redis åˆå§‹åŒ–æ—¶å°† **è‡ªåŠ¨è®¢é˜…**ã€‚  
    ä½ å¯ä»¥æ³¨å†Œ **è‡ªå®šä¹‰é¢‘é“å¤„ç†å™¨** æ¥å¤„ç†è¿™äº›é¢‘é“ä¸Šçš„æ¶ˆæ¯ï¼Œ  
    ä»è€Œå®ç°é™¤ WebSocket æˆ¿é—´é€šä¿¡ä¹‹å¤–çš„ **è‡ªå®šä¹‰è·¨æœé€šä¿¡é€»è¾‘**ã€‚

  - `redisConfig` `{Array<Object>}`ï¼šï¼ˆå¯é€‰ï¼‰Redis èŠ‚ç‚¹çš„é…ç½®ã€‚

    **è¯´æ˜**ï¼š  
    ç”¨äºè¿æ¥ä¸€ä¸ªæˆ–å¤šä¸ª Redis èŠ‚ç‚¹çš„é…ç½®æ•°ç»„ã€‚  
    æ¯ä¸ªå¯¹è±¡åº”åŒ…å« [ioredis](https://github.com/redis/ioredis) æ‰€éœ€çš„è¿æ¥å‚æ•°ï¼Œ  
    å¦‚ `host`ã€`port`ã€`password`ã€`db`ã€`tls` ç­‰ã€‚  
    æœ¬é…ç½®ç”¨äºå»ºç«‹å‘å¸ƒè€…ä¸è®¢é˜…è€…è¿æ¥ï¼Œæ”¯æŒè·¨æœåŠ¡å™¨é€šä¿¡ã€å¥åº·æ£€æŸ¥ä¸æ¶ˆæ¯è·¯ç”±ã€‚

---
## onCrossServerEvent(event, listener, tag)

### æè¿°  
æ³¨å†Œä¸€ä¸ª **è·¨æœåŠ¡å™¨äº‹ä»¶ç›‘å¬å™¨**ï¼Œç”¨äºå¤„ç†ä»å…¶ä»–æœåŠ¡å™¨èŠ‚ç‚¹å‘é€è¿‡æ¥çš„äº‹ä»¶ã€‚  

è¯¥å‡½æ•°æ”¯æŒæ³¨å†Œå¤šä¸ªç›‘å¬å™¨ï¼Œæ¯æ¬¡å…¶ä»–èŠ‚ç‚¹å¹¿æ’­å¯¹åº”äº‹ä»¶æ—¶ï¼Œæœ¬èŠ‚ç‚¹æ‰€æœ‰å¯¹åº”ç›‘å¬å™¨éƒ½ä¼šè¢«ä¾æ¬¡è°ƒç”¨ã€‚  

> ğŸ’¡ æ³¨æ„ï¼šåªæœ‰åœ¨ `enableCrossServer` å¯ç”¨çš„å‰æä¸‹ï¼Œè¯¥å‡½æ•°æ‰ä¼šç”Ÿæ•ˆã€‚  

### å‚æ•°

- `event` `{string}`ï¼šè¦ç›‘å¬çš„äº‹ä»¶åï¼ˆè·¨æœåŠ¡å™¨äº‹ä»¶åç§°ï¼‰ã€‚
- `listener` `{Function}`ï¼šäº‹ä»¶å¤„ç†å‡½æ•°ï¼Œæ¥æ”¶åˆ°è·¨æœåŠ¡å™¨å¹¿æ’­çš„äº‹ä»¶æ—¶å°†è¢«è°ƒç”¨ã€‚
- `tag` `{string|number}` [å¯é€‰]ï¼šç”¨äºæ ‡è¯†è¯¥ç›‘å¬å™¨çš„è‡ªå®šä¹‰æ ‡ç­¾ï¼Œæ–¹ä¾¿æœªæ¥ç§»é™¤ã€‚

### è¿”å›å€¼

- `void`

---

## onceCrossServerEvent(event, listener, tag)

### æè¿°  
æ³¨å†Œä¸€ä¸ª **åªè§¦å‘ä¸€æ¬¡çš„è·¨æœåŠ¡å™¨äº‹ä»¶ç›‘å¬å™¨**ï¼Œç”¨äºå¤„ç†ä»å…¶ä»–æœåŠ¡å™¨å‘é€è¿‡æ¥çš„äº‹ä»¶ã€‚  
è¯¥ç›‘å¬å™¨åœ¨ç¬¬ä¸€æ¬¡è§¦å‘åå°†ä¼šè‡ªåŠ¨ç§»é™¤ã€‚

> ğŸ’¡ æ³¨æ„ï¼šè¯¥å‡½æ•°ä»…åœ¨ `enableCrossServer` å¯ç”¨æ—¶ç”Ÿæ•ˆã€‚

### å‚æ•°

- `event` `{string}`ï¼šè¦ç›‘å¬çš„äº‹ä»¶åç§°ï¼ˆè·¨æœåŠ¡å™¨äº‹ä»¶ï¼‰ã€‚
- `listener` `{Function}`ï¼šäº‹ä»¶å¤„ç†å‡½æ•°ã€‚
- `tag` `{string|number}` [å¯é€‰]ï¼šç”¨äºæ ‡è¯†è¯¥ç›‘å¬å™¨çš„è‡ªå®šä¹‰æ ‡ç­¾ï¼Œæ–¹ä¾¿æœªæ¥ç§»é™¤ã€‚

### è¿”å›å€¼

- `void`

---

## offCrossServerEvent(event, listenerOrTag)

### åŠŸèƒ½è¯´æ˜

ç§»é™¤æŒ‡å®šçš„è·¨æœåŠ¡å™¨äº‹ä»¶ç›‘å¬å™¨ã€‚  
- è‹¥ä¼ å…¥çš„æ˜¯å‡½æ•°ï¼Œåˆ™ç§»é™¤è¯¥å‡½æ•°å¯¹åº”çš„ç›‘å¬å™¨ã€‚  
- è‹¥ä¼ å…¥çš„æ˜¯å­—ç¬¦ä¸²æˆ–æ•°å­—ï¼Œåˆ™ç§»é™¤åŒ¹é…è¯¥æ ‡ç­¾çš„ç›‘å¬å™¨ã€‚  
- è‹¥ä¸ä¼  `listenerOrTag`ï¼Œåˆ™ç§»é™¤è¯¥äº‹ä»¶ä¸‹çš„æ‰€æœ‰ç›‘å¬å™¨ã€‚

### å‚æ•°è¯´æ˜

- `event` `{string}`ï¼šè¦ç§»é™¤ç›‘å¬å™¨çš„äº‹ä»¶åç§°ã€‚
- `listenerOrTag` `{Function|string|number}` [å¯é€‰]ï¼šè¦ç§»é™¤çš„ç›‘å¬å‡½æ•°æˆ–æ ‡ç­¾ã€‚

### è¿”å›å€¼

- `void`

---

## publishRedisMessage(channel, message)

### æè¿°

å‘æŒ‡å®šçš„ Redis é¢‘é“å‘å¸ƒæ¶ˆæ¯ï¼Œä¸»è¦ç”¨äºå†…éƒ¨è·¨æœåŠ¡å™¨å¹¿æ’­å’Œ WebSocket è·¯ç”±ã€‚  
å½“å¼€å‘è€…éœ€è¦å‘è‡ªå®šä¹‰ Redis é¢‘é“å‘é€æ¶ˆæ¯æ—¶æ‰è°ƒç”¨ï¼Œé€šå¸¸ä¸éœ€è¦ç›´æ¥è°ƒç”¨æ­¤æ–¹æ³•ã€‚


### å‚æ•°

- `channel` `{string}`ï¼šè¦å‘å¸ƒæ¶ˆæ¯çš„ Redis é¢‘é“åç§°ï¼Œå¿…é¡»æ˜¯éç©ºå­—ç¬¦ä¸²ã€‚
- `message` `{Object}`ï¼šè¦å‘é€çš„æ¶ˆæ¯å¯¹è±¡ï¼Œä¼šè¢«è½¬ä¸ºå­—ç¬¦ä¸²æˆ–ç»è¿‡å‹ç¼©ç¼–ç å‘é€ã€‚

### è¿”å›å€¼

- `{boolean}`ï¼šå‘å¸ƒæ“ä½œæ˜¯å¦æˆåŠŸã€‚

### è¯¦ç»†è¯´æ˜

è¯¥æ–¹æ³•ç”¨äºå‘æŒ‡å®šçš„ Redis é¢‘é“å‘å¸ƒæ¶ˆæ¯ï¼Œæ”¯æŒå†…éƒ¨æˆ¿é—´å¹¿æ’­å’Œè‡ªå®šä¹‰é¢‘é“é€šè®¯ã€‚  
å¦‚æœæœªå¯ç”¨è·¨æœåŠ¡å™¨åŠŸèƒ½ï¼Œåˆ™å‘å¸ƒå¤±è´¥è¿”å› `false`ã€‚  
æ¶ˆæ¯å¯¹è±¡æ ¹æ®é…ç½®ä¼šè¢«è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼ˆä½¿ç”¨ JSON.stringifyï¼‰æˆ–ä½¿ç”¨ notepack å‹ç¼©ç¼–ç ã€‚  
è‹¥æ²¡æœ‰å¯ç”¨çš„å¥åº· Redis å®ä¾‹ï¼Œæˆ–è½¬æ¢å¤±è´¥ï¼Œåˆ™å‘å¸ƒå¤±è´¥ã€‚  
æˆåŠŸå‘å¸ƒè¿”å› `true`ï¼Œå¤±è´¥è¿”å› `false`ã€‚

---

## emitCrossServer(event, message, callback, options)

### æè¿°

ç”¨äºå‘ç›®æ ‡æœåŠ¡å™¨å‘é€äº‹ä»¶æ¶ˆæ¯ï¼Œæ”¯æŒå¹¿æ’­å’Œå®šå‘å‘é€ã€‚  
è¯¥æ–¹æ³•æ”¯æŒå¸¦å›è°ƒå‡½æ•°çš„è¯·æ±‚-å“åº”æœºåˆ¶ï¼Œå¹¿æ’­æ¨¡å¼ä¸‹ä¼šä¸ºæ¯ä¸ªç›®æ ‡æœåŠ¡å™¨çš„å“åº”åˆ†åˆ«è§¦å‘å›è°ƒã€‚  
å›è°ƒå‡½æ•°åœ¨æ¯æ”¶åˆ°ä¸€ä¸ªç›®æ ‡æœåŠ¡å™¨å“åº”æ—¶è°ƒç”¨ï¼Œå›è°ƒå‚æ•°ä¸­åŒ…å«å½“å‰å‰©ä½™æœªå“åº”æœåŠ¡å™¨çš„æ•°é‡ã€‚  
å½“è¾¾åˆ°é¢„æœŸå“åº”æ•°æˆ–è¶…æ—¶åï¼Œå›è°ƒä»ä¼šè¢«è§¦å‘ï¼Œé€šçŸ¥è°ƒç”¨è€…å“åº”ç»“æŸæˆ–è¶…æ—¶ã€‚  
æ¶ˆæ¯ä¼šä¼˜å…ˆåœ¨æœ¬åœ°æœåŠ¡å™¨å¤„ç†ï¼ˆå¦‚æœé€‚ç”¨ï¼‰ï¼Œç„¶åé€šè¿‡ Redis é¢‘é“è½¬å‘ç»™å…¶ä»–æœåŠ¡å™¨ã€‚  
å¦‚æœè·¨æœåŠ¡å™¨åŠŸèƒ½æœªå¯ç”¨æˆ–å‚æ•°æ— æ•ˆï¼Œåˆ™ç›´æ¥è¿”å›ä¸æ‰§è¡Œå‘é€ã€‚

### å‚æ•°

- `event` `{string}`ï¼šäº‹ä»¶åç§°ï¼Œä¸èƒ½ä¸ºç©ºå­—ç¬¦ä¸²ã€‚
- `message` `{Object}`ï¼šå‘é€çš„æ¶ˆæ¯å†…å®¹ã€‚
- `callback` `{Function}`ï¼ˆå¯é€‰ï¼‰ï¼šç”¨äºæ¥æ”¶ç›®æ ‡æœåŠ¡å™¨å“åº”çš„å›è°ƒå‡½æ•°ï¼Œä¼šè¢«å¤šæ¬¡è°ƒç”¨ã€‚
- `options` `{Object}`ï¼ˆå¯é€‰ï¼‰ï¼šé…ç½®å¯¹è±¡ã€‚
  - `targetServer` `{string|string[]}`ï¼ˆé»˜è®¤ `[]`ï¼‰ï¼šç›®æ ‡æœåŠ¡å™¨åˆ—è¡¨ï¼Œç©ºæ•°ç»„æˆ–ç©ºå­—ç¬¦ä¸²è¡¨ç¤ºå¹¿æ’­åˆ°æ‰€æœ‰æœåŠ¡å™¨ã€‚
  - `timeout` `{number}`ï¼ˆé»˜è®¤ `5000` æ¯«ç§’ï¼‰ï¼šå›è°ƒè¶…æ—¶æ—¶é—´ï¼Œè¶…æ—¶åè§¦å‘ä¸€æ¬¡å›è°ƒé€šçŸ¥ã€‚
  - `expectedResponses` `{number}`ï¼ˆé»˜è®¤å¹¿æ’­æ—¶ä¸º 1ï¼Œå®šå‘æ—¶ä¸ºç›®æ ‡æœåŠ¡å™¨æ•°é‡ï¼‰ï¼šæœŸæœ›æ¥æ”¶çš„å“åº”æ•°é‡ã€‚
  - `exceptSelf` `{boolean}`ï¼ˆé»˜è®¤å€¼ä¸º `false`ï¼‰ï¼šæ˜¯å¦åœ¨å¹¿æ’­æ—¶æ’é™¤å½“å‰æœåŠ¡å™¨å¤„ç†æ¶ˆæ¯ã€‚  
  è¯¥å‚æ•°ä»…åœ¨æ‰§è¡Œå…¨å±€å¹¿æ’­æ—¶ç”Ÿæ•ˆï¼Œå³ `targetServer` ä¸ºä¸€ä¸ªç©ºæ•°ç»„ (`[]`) çš„æƒ…å†µä¸‹ã€‚  
  å¦‚æœ `targetServer` æŒ‡å®šäº†ä¸€ä¸ªæˆ–å¤šä¸ªæœåŠ¡å™¨ï¼Œ`exceptSelf` ä¼šè¢«å¿½ç•¥ï¼Œå½“å‰æœåŠ¡å™¨å¦‚æœåœ¨ç›®æ ‡ä¸­åˆ™ä¼šå¤„ç†è¯¥æ¶ˆæ¯ã€‚

### å…³äº `expectedResponses`

åœ¨å¹¿æ’­æ¨¡å¼ï¼ˆå³ `targetServer` ä¸º `[]`ï¼‰ä¸‹ï¼Œç³»ç»Ÿæ— æ³•è‡ªåŠ¨å¾—çŸ¥å½“å‰é›†ç¾¤ä¸­å®é™…åœ¨çº¿çš„æœåŠ¡å™¨èŠ‚ç‚¹æ•°é‡ã€‚  
åŸæœ¬çš„åšæ³•æ˜¯æå‰é™æ€æ³¨å†Œæ‰€æœ‰æœåŠ¡å™¨åç§°æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½†å®è·µä¸­å‘ç°è¿™ç§æ–¹å¼ç¼ºä¹çµæ´»æ€§ï¼Œä¸”åœ¨åŠ¨æ€å¢åˆ èŠ‚ç‚¹æ—¶ä¼šå¸¦æ¥è¾ƒå¤§çš„ç»´æŠ¤æˆæœ¬ã€‚

ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼ŒæœåŠ¡å™¨åˆ—è¡¨çš„ç®¡ç†æƒäº¤ç»™äº†å¼€å‘è€…ã€‚  
å½“éœ€è¦å¹¿æ’­æ¶ˆæ¯æ—¶ï¼Œå¼€å‘è€…éœ€è¦æ‰‹åŠ¨æŒ‡å®š `expectedResponses` çš„å€¼ï¼Œè¡¨ç¤ºé¢„æœŸæœ‰å¤šå°‘ä¸ªæœåŠ¡å™¨ä¼šå¯¹è¯¥æ¶ˆæ¯åšå‡ºå“åº”ã€‚  
è¿™ç§è®¾è®¡è®©ç³»ç»Ÿæ›´åŠ **çµæ´»å¯æ‰©å±•**ï¼Œå¯ä»¥æ”¯æŒæœåŠ¡é›†ç¾¤çš„åŠ¨æ€æ‰©å®¹ä¸ç¼©å‡ï¼Œè€Œæ— éœ€è¿›è¡Œé›†ä¸­å¼é…ç½®æˆ–åŒæ­¥ã€‚

> åœ¨ç‚¹å¯¹ç‚¹æ¨¡å¼ï¼ˆå³ `targetServer` ä¸ºæŒ‡å®šæœåŠ¡å™¨åˆ—è¡¨ï¼‰ä¸‹ï¼Œ`expectedResponses` ä¼šè‡ªåŠ¨è®¾ç½®ä¸ºç›®æ ‡æœåŠ¡å™¨æ•°é‡ã€‚

### è¿”å›å€¼

- `void`ï¼šæ— è¿”å›å€¼ã€‚

### è¯¦ç»†è¯´æ˜

è¯¥æ–¹æ³•ä¸ºè·¨æœåŠ¡å™¨äº‹ä»¶å‘é€çš„æ ¸å¿ƒæ¥å£ï¼Œæ”¯æŒå‘æŒ‡å®šæœåŠ¡å™¨æˆ–å…¨éƒ¨æœåŠ¡å™¨å¹¿æ’­æ¶ˆæ¯ã€‚  
å›è°ƒå‡½æ•°ä¼šåœ¨æ¯ä¸ªç›®æ ‡æœåŠ¡å™¨å“åº”æ—¶è§¦å‘ä¸€æ¬¡ï¼Œå¹¶ä¼ å…¥å‚æ•°åŒ…å«ï¼š

- `success` `{boolean}`ï¼šæœ¬æ¬¡å“åº”æ˜¯å¦æˆåŠŸã€‚
- `data` `{Object}`ï¼šç›®æ ‡æœåŠ¡å™¨è¿”å›çš„æ•°æ®ï¼ˆæˆåŠŸæ—¶ï¼‰ã€‚
- `remainingResponses` `{number}`ï¼šå½“å‰å‰©ä½™æœªå“åº”çš„æœåŠ¡å™¨æ•°é‡ã€‚
- `error` `{string}`ï¼ˆä»…å¤±è´¥æ—¶ï¼‰ï¼šé”™è¯¯ä¿¡æ¯ã€‚
- `callbackId` `{string}`ï¼šç”¨äºæ ‡è¯†è¯¥å›è°ƒçš„å”¯ä¸€ IDã€‚
- `unrespondedCount` `{number}`ï¼ˆä»…è¶…æ—¶æ—¶ï¼‰ï¼šæœªå“åº”çš„æœåŠ¡å™¨æ•°é‡ã€‚

å½“æ‰€æœ‰é¢„æœŸå“åº”éƒ½æ”¶åˆ°æˆ–è¶…æ—¶è§¦å‘æ—¶ï¼Œå›è°ƒå°†è¢«è°ƒç”¨é€šçŸ¥è°ƒç”¨æ–¹ã€‚  
å¹¿æ’­æ¶ˆæ¯æ—¶ï¼Œé™¤éè®¾ç½® `exceptSelf: true`ï¼Œå½“å‰æœåŠ¡å™¨ä¹Ÿä¼šå¤„ç†è¯¥æ¶ˆæ¯ã€‚  
å®šå‘å‘é€æ—¶ï¼ŒæœŸæœ›å“åº”æ•°é»˜è®¤ç­‰äºç›®æ ‡æœåŠ¡å™¨æ•°é‡ï¼Œå¹¿æ’­é»˜è®¤æœŸæœ›å“åº”æ•°ä¸º 1ï¼ˆå¯è¦†ç›–ï¼‰ã€‚  
æ¶ˆæ¯ä¼šå…ˆåœ¨æœ¬åœ°å¤„ç†ï¼ˆå¦‚æœé€‚ç”¨ï¼‰ï¼Œå†é€šè¿‡ Redis é¢‘é“å‘å¸ƒç»™å…¶ä»–æœåŠ¡å™¨ã€‚  
å¦‚æœè·¨æœåŠ¡å™¨åŠŸèƒ½æœªå¼€å¯ï¼Œæˆ–æ¶ˆæ¯å†…å®¹æ— æ•ˆï¼Œå°†ç›´æ¥è¿”å›ä¸åšå¤„ç†ã€‚

### ç¤ºä¾‹

```js
adapter.emitCrossServer(
  'updateGameState',  // äº‹ä»¶åç§°
  { state: 'levelUp', level: 5 },  // æ¶ˆæ¯ä½“
  (response) => {  // å›è°ƒï¼Œå¯èƒ½è¢«å¤šæ¬¡è°ƒç”¨
    if (response.success) {
      console.log(`æ”¶åˆ°æœåŠ¡å™¨å“åº”ï¼Œå‰©ä½™æœªå“åº”æ•°é‡: ${response.remainingResponses}`);
      console.log('å“åº”æ•°æ®:', response.data);

      // é‡è¦æç¤ºï¼š
      // response.data.callbackId åŒ…å«æœ¬æ¬¡è¯·æ±‚çš„å”¯ä¸€å›è°ƒ IDã€‚
      // ç»“åˆä¸šåŠ¡é€»è¾‘ï¼Œä½ å¯ä»¥åˆ¤æ–­æ˜¯å¦å·²ç»æ”¶åˆ°äº†è¶³å¤Ÿçš„æœåŠ¡å™¨å“åº”ï¼Œ
      // æ»¡è¶³æ¡ä»¶æ—¶è°ƒç”¨ this.deleteCrossServerCallback(callbackId) ä¸»åŠ¨é”€æ¯å›è°ƒï¼Œ
      // åç»­çš„æœåŠ¡å™¨å“åº”å°†ä¸ä¼šè§¦å‘å›è°ƒã€‚
      // ä¸å¤„ç†çš„è¯ï¼Œç³»ç»Ÿä¼šåœ¨è¶…æ—¶åè‡ªåŠ¨æ¸…ç†å›è°ƒã€‚
      // response.data.senderServer è¡¨ç¤ºè¯¥å“åº”æ˜¯ç”±å“ªä¸ªæœåŠ¡å™¨è¿”å›çš„ã€‚å¯ç”¨äºåœ¨å¤šæœåŠ¡å™¨å¹¿æ’­åœºæ™¯ä¸‹ï¼Œè¯†åˆ«æ¯æ¡å“åº”çš„æ¥æºæœåŠ¡å™¨ã€‚
    } else {
      console.error('å¹¿æ’­å›è°ƒå¤±è´¥æˆ–è¶…æ—¶:', response.error);
      console.error('æœªå“åº”æœåŠ¡å™¨æ•°é‡:', response.unrespondedCount);
    }
  },
  { timeout: 3000, expectedResponses: 3 }  // è¶…æ—¶ 3 ç§’ï¼ŒæœŸæœ› 3 ä¸ªæœåŠ¡å™¨å“åº”
  // é»˜è®¤ä¸è®¾ç½® targetServer æˆ–è®¾ç½®ä¸º [] è¡¨ç¤ºå¹¿æ’­æ¨¡å¼ï¼Œ
  // æ­¤æ—¶ expectedResponses è¡¨ç¤ºé¢„æœŸéœ€è¦å“åº”çš„æœåŠ¡å™¨èŠ‚ç‚¹æ•°é‡ï¼ˆå¿…é¡»æ‰‹åŠ¨è®¾ç½®ï¼‰ã€‚å¦åˆ™ä¼šé»˜è®¤ä¸º 1ã€‚
  // å¦‚æœè®¾ç½®äº† targetServer=['serverA','serverB']ï¼Œè¡¨ç¤ºç‚¹å¯¹ç‚¹å‘é€ï¼Œ
  // é‚£ä¹ˆ expectedResponses å¯çœç•¥ï¼Œç³»ç»Ÿä¼šé»˜è®¤å–ç›®æ ‡æœåŠ¡å™¨æ•°é‡ä½œä¸ºé¢„æœŸå“åº”æ•°ã€‚
);
```
### è¡¥å……è¯´æ˜ï¼šè·å–å“åº”æ–¹æœåŠ¡å™¨åç§°

æ¯æ¬¡å›è°ƒå“åº”ä¸­éƒ½åŒ…å«å­—æ®µ `response.data.senderServer`ï¼Œ  
ç”¨äºæ ‡è¯†è¯¥å“åº”æ˜¯**ç”±å“ªä¸ªæœåŠ¡å™¨**è¿”å›çš„ã€‚

å¼€å‘è€…å¯ä»¥å€Ÿæ­¤ï¼š

- è·Ÿè¸ªå·²å“åº”çš„æœåŠ¡å™¨åˆ—è¡¨
- é…åˆä¸šåŠ¡é€»è¾‘å¤„ç†ä¸åŒæœåŠ¡å™¨çš„å“åº”
- åŠ¨æ€åˆ¤æ–­æ˜¯å¦æå‰ç»“æŸå›è°ƒï¼ˆä¾‹å¦‚é€šè¿‡ `deleteCrossServerCallback(callbackId)` æ‰‹åŠ¨é”€æ¯ï¼‰

> âš ï¸ æ³¨æ„ï¼šæå‰é”€æ¯å›è°ƒåï¼Œå…¶ä½™æœªå“åº”æœåŠ¡å™¨çš„è¿”å›ç»“æœå°†è¢«å¿½ç•¥ã€‚


---

## emitCrossServerWithPromise(event, message, options)

### æè¿°

å¹¿æ’­è·¨æœåŠ¡å™¨äº‹ä»¶ï¼Œè¿”å›ä¸€ä¸ª Promiseï¼Œè¯¥ Promise ä¼šåœ¨æ‰€æœ‰é¢„æœŸå“åº”æ”¶åˆ°æˆ–è¶…æ—¶åè¢«è§£å†³ã€‚

æ­¤æ–¹æ³•æ”¯æŒå‘ä¸€ä¸ªæˆ–å¤šä¸ªæœåŠ¡å™¨å‘é€æ¶ˆæ¯ï¼ˆæˆ–å¹¿æ’­åˆ°æ‰€æœ‰æœåŠ¡å™¨ï¼‰ï¼Œå¹¶ç­‰å¾…ç›®æ ‡æœåŠ¡å™¨çš„å“åº”ï¼Œä½¿ç”¨ Promise æ–¹å¼å®ç°å¼‚æ­¥å¤„ç†ã€‚

### å‚æ•°

- `event` `{string}`  
  è¦å‘é€çš„äº‹ä»¶åç§°ã€‚

- `message` `{Object}`  
  æºå¸¦çš„æ¶ˆæ¯è´Ÿè½½ã€‚

- `options` `{Object}`ï¼ˆå¯é€‰ï¼‰  
  é¢å¤–é…ç½®é¡¹ã€‚

  - `targetServer` `{string|string[]}`ï¼ˆé»˜è®¤ `[]`ï¼‰  
    ç›®æ ‡æœåŠ¡å™¨åç§°æˆ–åç§°æ•°ç»„ã€‚ä¸ºç©ºæˆ–ä¸ä¼ è¡¨ç¤ºå¹¿æ’­ç»™æ‰€æœ‰æœåŠ¡å™¨ã€‚

  - `timeout` `{number}`ï¼ˆé»˜è®¤ `5000`ï¼‰  
    ç­‰å¾…å“åº”çš„è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ï¼Œè¶…æ—¶å Promise ä»¥å¤±è´¥è§£å†³ã€‚

  - `expectedResponses` `{number}`ï¼ˆé»˜è®¤ `1`ï¼‰  
    é¢„æœŸå“åº”çš„æœåŠ¡å™¨æ•°é‡ã€‚  
    å¹¿æ’­æ—¶å¿…é¡»æ˜¾å¼æŒ‡å®šï¼Œå¦åˆ™é»˜è®¤ 1ï¼›æŒ‡å®šç›®æ ‡æœåŠ¡å™¨æ—¶ï¼Œå†…éƒ¨è‡ªåŠ¨è®¾ç½®ä¸ºç›®æ ‡æœåŠ¡å™¨æ•°é‡ã€‚

  - `exceptSelf` `{boolean}`ï¼ˆé»˜è®¤ `false`ï¼‰  
    å¹¿æ’­æ—¶æ˜¯å¦æ’é™¤å½“å‰æœåŠ¡å™¨å¤„ç†ã€‚

### è¿”å›å€¼

`Promise<Object>` â€” è¿”å›ç»“æœå¯¹è±¡ï¼š

- æˆåŠŸæ—¶(æ‰€æœ‰é¢„æœŸå“åº”æ”¶åˆ°):

  ```js
  {
    success: true,
    responses: { [serverName]: responseData, ... }
  }
  ```
- è¶…æ—¶å¤±è´¥æ—¶ï¼š

  ```js
  {
    success: false,
    message: 'Cross-server callback timed out.',
    responses: { [serverName]: responseData, ... },
    unrespondedCount: number
  }
  ```
### è¯´æ˜

è¯¥å‡½æ•°ä¸ `emitCrossServer` ä¸åŒï¼Œå®ƒä¼šç­‰å¾…æ‰€æœ‰é¢„æœŸçš„å“åº”æ•°é‡å…¨éƒ¨å®Œæˆåï¼Œæ‰ä¼šè¿”å› Promiseã€‚

è€Œ `emitCrossServer` æ˜¯æ¯å½“ä¸€ä¸ªæœåŠ¡å™¨è¿”å›æ•°æ®æ—¶å°±è°ƒç”¨å›è°ƒå‡½æ•°ï¼Œä¸ä¼šç­‰å¾…å…¨éƒ¨å“åº”ã€‚

### ç¤ºä¾‹ä»£ç 

  ```js
  // å¹¿æ’­æ¨¡å¼ï¼Œç­‰å¾…3ä¸ªæœåŠ¡å™¨å“åº”ï¼Œè¶…æ—¶æ—¶é—´3ç§’
  adapter.emitCrossServerWithPromise(
    'syncPlayerData',                   // äº‹ä»¶åç§°
    { playerId: 123, score: 4567 },    // å‘é€çš„æ•°æ®
    { timeout: 3000, expectedResponses: 3 } // é€‰é¡¹ï¼š3ç§’è¶…æ—¶ï¼Œé¢„æœŸ3ä¸ªå“åº”
  ).then(result => {
    if (result.success) {
      console.log('æ‰€æœ‰æœåŠ¡å™¨å“åº”å®Œæˆ:', result.responses);
    } else {
      console.warn('éƒ¨åˆ†æœåŠ¡å™¨æœªå“åº”ï¼Œè¶…æ—¶æˆ–å¤±è´¥', result.unrespondedCount);
      console.log('å·²æ”¶åˆ°çš„å“åº”:', result.responses);
    }
  });
  ```

### ç¤ºä¾‹ä»£ç (awaitæ–¹å¼)

  ```js
  async function syncData() {
    const result = await adapter.emitCrossServerWithPromise(
      'syncPlayerData',                   // äº‹ä»¶åç§°
      { playerId: 123, score: 4567 },    // å‘é€çš„æ•°æ®
      { timeout: 3000, expectedResponses: 3 } // é€‰é¡¹ï¼š3ç§’è¶…æ—¶ï¼Œé¢„æœŸ3ä¸ªå“åº”
    );

    if (result.success) {
      console.log('æ‰€æœ‰æœåŠ¡å™¨å“åº”å®Œæˆ:', result.responses);
    } else {
      console.log('éƒ¨åˆ†æœåŠ¡å™¨æœªå“åº”ï¼Œè¶…æ—¶æˆ–å¤±è´¥', result.unrespondedCount);
      console.log('å·²æ”¶åˆ°çš„å“åº”:', result.responses);
    }
  }

  syncData();

  ```

---

## deleteCrossServerCallback(callbackId)

### æè¿°

æ‰‹åŠ¨åˆ é™¤ä¸€ä¸ªè·¨æœåŠ¡å™¨å›è°ƒå‡½æ•°ï¼Œæ ¹æ®å›è°ƒ ID åˆ é™¤ã€‚

### å‚æ•°

- `callbackId` `{string}`: è¦åˆ é™¤çš„å›è°ƒå‡½æ•° IDã€‚

### è¿”å›å€¼

- `{boolean}`: å¦‚æœå›è°ƒå­˜åœ¨å¹¶è¢«æˆåŠŸåˆ é™¤ï¼Œè¿”å› trueï¼›å¦åˆ™è¿”å› falseã€‚

### ä½¿ç”¨åœºæ™¯è¯´æ˜  
å½“ä½¿ç”¨ `emitCrossServer` è¿›è¡Œå…¨å±€å¹¿æ’­å¹¶æ³¨å†Œå›è°ƒå‡½æ•°æ—¶ï¼Œå¼€å‘è€…å¯ä»¥æ ¹æ®å›è°ƒçš„ç»“æœå’Œé¢„æœŸçš„å“åº”æƒ…å†µï¼Œä¸»åŠ¨è°ƒç”¨è¯¥å‡½æ•°æå‰åˆ é™¤å¯¹åº”çš„å›è°ƒã€‚å¦‚æœä¸è¿›è¡Œæ‰‹åŠ¨åˆ é™¤ï¼Œä¸”åœ¨è®¾å®šçš„è¶…æ—¶æ—¶é—´å†…æœªæ”¶é›†å®Œæˆé¢„æœŸçš„æœåŠ¡å™¨å“åº”ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æ¸…é™¤è¯¥å›è°ƒã€‚

å› æ­¤ï¼Œå¼€å‘è€…åº”ç»“åˆè‡ªèº«ä¸šåŠ¡é€»è¾‘ï¼Œåœ¨åˆé€‚çš„æ—¶æœºè°ƒç”¨æ­¤æ–¹æ³•åˆ é™¤å›è°ƒã€‚åˆ é™¤åï¼Œåç»­æœåŠ¡å™¨å¯¹è¯¥å›è°ƒçš„å“åº”å°†ä¸å†è¢«æ¥æ”¶å’Œå¤„ç†ã€‚

---

## manualSubscribe(channel)

### æè¿°

æ‰‹åŠ¨è®¢é˜…æŒ‡å®šçš„ Redis é¢‘é“ã€‚

### å‚æ•°

- `channel` `{string}`: éœ€è¦è®¢é˜…çš„ Redis é¢‘é“åç§°ã€‚

### è¿”å›å€¼

- `void`

---

## manualUnsubscribe(channel)

### æè¿°

æ‰‹åŠ¨å–æ¶ˆè®¢é˜…æŒ‡å®šçš„ Redis é¢‘é“ã€‚

### å‚æ•°

- `channel` `{string}`: éœ€è¦å–æ¶ˆè®¢é˜…çš„ Redis é¢‘é“åç§°ã€‚

### è¿”å›å€¼

- `void`

---

## setCustomChannelHandler(handler)

### æè¿°

è®¾ç½®è‡ªå®šä¹‰é¢‘é“æ¶ˆæ¯å¤„ç†å‡½æ•°ã€‚

### å‚æ•°

- `handler` `{Function}`: è‡ªå®šä¹‰çš„æ¶ˆæ¯å¤„ç†å‡½æ•°ã€‚

### è¿”å›å€¼

- `void`

---

## removeCustomChannelHandler()

### æè¿°

ç§»é™¤è‡ªå®šä¹‰é¢‘é“æ¶ˆæ¯å¤„ç†å‡½æ•°ã€‚

### å‚æ•°

æ— å‚æ•°ã€‚

### è¿”å›å€¼

- `void`

---

## addRedisInstance(config)

### æè¿°

æ·»åŠ ä¸€ä¸ª Redis å®ä¾‹ï¼Œå¹¶æ ¹æ®é…ç½®é€‰æ‹©æ€§å¯åŠ¨å¥åº·æ£€æŸ¥æœºåˆ¶ã€‚

è¯¥æ–¹æ³•å¯ä»¥åŠ¨æ€åœ°å‘ç³»ç»Ÿä¸­åŠ å…¥æ–°çš„ Redis èŠ‚ç‚¹ï¼ˆå‘å¸ƒè€…å’Œè®¢é˜…è€…ï¼‰ï¼Œå¹¶è®¾ç½®ç›¸å…³äº‹ä»¶ç›‘å¬å’Œæ¶ˆæ¯å¤„ç†ã€‚å¦‚æœå­˜åœ¨å¤šä¸ª Redis å®ä¾‹ï¼Œä¸”æ»¡è¶³ä»¥ä¸‹ä»»ä¸€æ¡ä»¶ï¼š

1. `redisForcePing` è¢«å¯ç”¨ï¼Œæˆ–è€…  
2. `selectionStrategy` è®¾ç½®ä¸º `'fastest'`

åˆ™ä¼šå¯åŠ¨ä¸€ä¸ªè®¡æ—¶å™¨ï¼Œå®šæ—¶å¯¹æ‰€æœ‰ Redis èŠ‚ç‚¹è¿›è¡Œ ping æ“ä½œï¼Œä»¥ç›‘æµ‹å®ƒä»¬çš„å¥åº·çŠ¶æ€ã€‚æ¶ˆæ¯çš„å…·ä½“å‘å¸ƒåˆ™ç”±é…ç½®çš„é€‰æ‹©ç­–ç•¥å†³å®šã€‚

### å‚æ•°

- `config` `{object}`: Redis å®¢æˆ·ç«¯è¿æ¥é…ç½®å¯¹è±¡ã€‚

### è¿”å›å€¼

- `void`

---

## getHealthyRedisInstancesCount(type)

### æè¿°

è·å–æŒ‡å®šç±»å‹çš„å¥åº· Redis å®ä¾‹æ•°é‡ã€‚

è¯¥æ–¹æ³•æ ¹æ®ä¼ å…¥çš„ç±»å‹ï¼ˆ'publisher' æˆ– 'subscriber'ï¼‰è¿‡æ»¤ Redis å®ä¾‹ï¼Œæ£€æŸ¥å…¶å¥åº·çŠ¶æ€ï¼ˆ`isHealthy` ä¸ºçœŸï¼‰ï¼Œå¹¶è¿”å›å¥åº·å®ä¾‹çš„æ•°é‡ã€‚

### å‚æ•°

- `type` `{string}`: è¦ç»Ÿè®¡çš„ Redis å®ä¾‹ç±»å‹ã€‚å¿…é¡»ä¸º `'publisher'` æˆ– `'subscriber'`ã€‚

### è¿”å›å€¼

- `{number}`: æŒ‡å®šç±»å‹å¥åº· Redis å®ä¾‹çš„æ•°é‡ã€‚

---

## getRedisInstancesCount()

### æè¿°

è¿”å›å½“å‰ç®¡ç†çš„ Redis å®ä¾‹æ€»æ•°é‡ã€‚

### å‚æ•°

æ— 

### è¿”å›å€¼

- `{number}`: Redis å®ä¾‹çš„æ€»æ•°ã€‚

---

## onWebSocketEvent(event, listener, tag)

### æè¿°
æ³¨å†Œä¸€ä¸ªé’ˆå¯¹ç‰¹å®š WebSocket äº‹ä»¶çš„ç›‘å¬å™¨ã€‚  
ä½ å¯ä»¥æ³¨å†Œå¯¹åº”çš„ç³»ç»Ÿäº‹ä»¶å‡½æ•°ï¼Œå¯¹ç³»ç»Ÿäº‹ä»¶è¿›è¡Œå¤„ç†ã€‚

### ç³»ç»Ÿå†…ç½® WebSocket äº‹ä»¶è¯´æ˜
- `connection`ï¼šå½“å®¢æˆ·ç«¯è¿æ¥æ—¶è§¦å‘ï¼Œå›è°ƒå‚æ•°ï¼š(socket, req)
- `close`ï¼šå½“å®¢æˆ·ç«¯æ–­å¼€æ—¶è§¦å‘ï¼Œå›è°ƒå‚æ•°ï¼š(socket, req, code, reason)
- `error`ï¼šå½“å®¢æˆ·ç«¯å‘ç”Ÿé”™è¯¯æ—¶è§¦å‘ï¼Œå›è°ƒå‚æ•°ï¼š(socket, req, error)
- `pong`ï¼šå½“å®¢æˆ·ç«¯å“åº”æœåŠ¡å™¨å‘é€çš„ ping å¸§æ—¶è§¦å‘ï¼Œå›è°ƒå‚æ•°ï¼š(socket, req)
- `message`ï¼šå½“æ”¶åˆ°å®¢æˆ·ç«¯æ¶ˆæ¯æ—¶è§¦å‘ï¼Œå›è°ƒå‚æ•°ï¼š(socket, message)
- `client-ping`ï¼šå½“æ”¶åˆ°å®¢æˆ·ç«¯ä¸»åŠ¨å‘é€çš„ ping æ¶ˆæ¯æ—¶è§¦å‘ï¼Œå›è°ƒå‚æ•°ï¼š(socket)
- `server-error`ï¼šå½“ WebSocket æœåŠ¡å™¨å‘ç”Ÿé”™è¯¯æ—¶è§¦å‘ï¼Œå›è°ƒå‚æ•°ï¼š(err)
- `listening`ï¼šå½“ WebSocket æœåŠ¡å™¨å¼€å§‹ç›‘å¬æ—¶è§¦å‘
- `ws-server-close`ï¼šå½“ WebSocket æœåŠ¡å™¨å…³é—­æ—¶è§¦å‘

### å‚æ•°
- `event` {string|number} â€” è¦ç›‘å¬çš„äº‹ä»¶åç§°ã€‚  
- `listener` {Function} â€” å½“äº‹ä»¶è¢«è§¦å‘æ—¶è°ƒç”¨çš„å›è°ƒå‡½æ•°ã€‚  
- `tag` {string|number} [å¯é€‰] â€” ç”¨äºæ ‡è¯†ç›‘å¬å™¨çš„è‡ªå®šä¹‰æ ‡ç­¾ï¼Œæ–¹ä¾¿åç»­ç§»é™¤ã€‚

### è¿”å›å€¼
- void

---

## onceWebSocketEvent(event, listener, tag)

### æè¿°
æ³¨å†Œä¸€ä¸ªä»…ä¼šè¢«è§¦å‘ä¸€æ¬¡çš„ç‰¹å®š WebSocket äº‹ä»¶ç›‘å¬å™¨ã€‚

### å‚æ•°
- `event` {string|number} â€” è¦ç›‘å¬çš„äº‹ä»¶åç§°ã€‚  
- `listener` {Function} â€” å½“äº‹ä»¶è¢«è§¦å‘æ—¶è°ƒç”¨çš„å›è°ƒå‡½æ•°ã€‚  
- `tag` {string|number} [å¯é€‰] â€” ç”¨äºæ ‡è¯†ç›‘å¬å™¨çš„è‡ªå®šä¹‰æ ‡ç­¾ï¼Œæ–¹ä¾¿åç»­ç§»é™¤ã€‚

### è¿”å›å€¼
- void

---

## offWebSocketEvent(event, listenerOrTag)

### æè¿°
ç§»é™¤ç‰¹å®š WebSocket äº‹ä»¶çš„ç›‘å¬å™¨ã€‚  
- å¦‚æœ `listenerOrTag` æ˜¯å‡½æ•°ï¼Œåˆ™ç§»é™¤å¯¹åº”çš„å‡½æ•°ç›‘å¬å™¨ã€‚  
- å¦‚æœæ˜¯å­—ç¬¦ä¸²æˆ–æ•°å­—ï¼Œåˆ™ç§»é™¤å¯¹åº”æ ‡ç­¾çš„ç›‘å¬å™¨ã€‚  
- å¦‚æœæœªä¼ ï¼Œåˆ™ç§»é™¤è¯¥äº‹ä»¶ä¸‹æ‰€æœ‰ç›‘å¬å™¨ã€‚

### å‚æ•°
- `event` {string|number} â€” è¦ç§»é™¤ç›‘å¬å™¨çš„äº‹ä»¶åç§°ã€‚  
- `listenerOrTag` {Function|string|number} [å¯é€‰] â€” è¦ç§»é™¤çš„ç›‘å¬å‡½æ•°æˆ–æ ‡ç­¾ï¼Œè‹¥ä¸ä¼ åˆ™ç§»é™¤è¯¥äº‹ä»¶ä¸‹æ‰€æœ‰ç›‘å¬å™¨ã€‚

### è¿”å›å€¼
- void

---

## broadcastToRoom(roomNamespace, roomId, event, data, options)

### æè¿°
å‘æŒ‡å®šæˆ¿é—´å†…çš„æ‰€æœ‰ WebSocket å®¢æˆ·ç«¯å¹¿æ’­æ¶ˆæ¯ã€‚  
- å½“ `options.localOnly` ä¸º true æ—¶ï¼Œä»…å‘æœ¬åœ°å®¢æˆ·ç«¯å¹¿æ’­ã€‚  
- ä½ å¯ä»¥ä½¿ç”¨ `options.excludeSocketIds` æ’é™¤æŒ‡å®šå®¢æˆ·ç«¯ã€‚  
- å½“ `options.localOnly` ä¸º false æ—¶ï¼Œé€šè¿‡ Redis è·¨æœåŠ¡å™¨å¹¿æ’­ã€‚  
- å½“ `options.roomDstroy` ä¸º true æ—¶ï¼Œå¹¿æ’­ç»“æŸåç«‹å³é”€æ¯æˆ¿é—´ã€‚

### å‚æ•°
- `roomNamespace` {string} - æˆ¿é—´å‘½åç©ºé—´ï¼ˆä¾‹å¦‚ 'chat', 'gameRoom'ï¼‰ã€‚
- `roomId` {string} - å‘½åç©ºé—´ä¸‹å…·ä½“çš„æˆ¿é—´ IDã€‚
- `event` {string} - è¦å¹¿æ’­çš„äº‹ä»¶åç§°ã€‚
- `data` {Object} - è¦å‘é€ç»™æˆ¿é—´çš„æ¶ˆæ¯æ•°æ®ã€‚
- `options` {Object} [å¯é€‰] - é¢å¤–çš„å¯é€‰å‚æ•°ã€‚
  - `excludeSocketIds` {string[]} [å¯é€‰ï¼Œé»˜è®¤=[]] - æ’é™¤æ¥æ”¶æ¶ˆæ¯çš„ socketId åˆ—è¡¨ã€‚
  - `localOnly` {boolean} [å¯é€‰ï¼Œé»˜è®¤=false] - æ˜¯å¦ä»…å‘æœ¬åœ°å®¢æˆ·ç«¯å¹¿æ’­ã€‚
  - `roomDstroy` {boolean} [å¯é€‰ï¼Œé»˜è®¤=false] - æ˜¯å¦åœ¨æœ¬åœ°å¹¿æ’­åé”€æ¯æˆ¿é—´ã€‚

### è¿”å›å€¼
- `void`

---

## toSocketId(socketId, event, data)

### æè¿°
å‘æŒ‡å®šç©å®¶ï¼ˆé€šè¿‡ WebSocket `socketId` æ ‡è¯†ï¼‰å‘é€æ¶ˆæ¯ã€‚  
- å½“ WebSocket æœåŠ¡å…³é—­æ—¶ï¼Œæ¶ˆæ¯ä¸ä¼šè¢«å‘é€ã€‚  
- å¦‚æœç©å®¶åœ¨æœ¬åœ°è¿æ¥ï¼Œæ¶ˆæ¯å°†ç›´æ¥å‘é€ã€‚  
- å¦åˆ™ï¼Œæ¶ˆæ¯é€šè¿‡ Redis å‘å¸ƒå®ç°è·¨æœåŠ¡å™¨ä¼ é€’ã€‚  

### å‚æ•°
- `socketId` {string} - ç©å®¶ WebSocket çš„ socketIdï¼Œå¿…é¡»æ˜¯éç©ºå­—ç¬¦ä¸²ã€‚
- `event` {string} - è¦å‘é€çš„äº‹ä»¶åç§°ã€‚
- `data` {Object} - è¦å‘é€çš„æ¶ˆæ¯æ•°æ®ã€‚

### è¿”å›å€¼
- `void`

---

## toSocketIds(socketIds, event, data)

### æè¿°
å‘å¤šä¸ªç©å®¶ï¼ˆé€šè¿‡ WebSocket `socketIds` æ ‡è¯†ï¼‰å‘é€æ¶ˆæ¯ã€‚  
- å½“ WebSocket æœåŠ¡å…³é—­æ—¶ï¼Œæ“ä½œè·³è¿‡ã€‚  
- æ¶ˆæ¯ç›´æ¥å‘é€ç»™æœ¬åœ°è¿æ¥çš„ç©å®¶ã€‚  
- å¯¹äºæœªè¿æ¥åˆ°æœ¬åœ°æœåŠ¡å™¨çš„ç©å®¶ï¼Œé€šè¿‡ Redis å‘å¸ƒå®ç°è·¨æœåŠ¡å™¨ä¼ é€’ã€‚

### å‚æ•°
- `socketIds` {Array<string>} - ç©å®¶ WebSocket socketId çš„æ•°ç»„ã€‚
- `event` {string} - è¦å‘é€çš„äº‹ä»¶åç§°ã€‚
- `data` {Object} - è¦å‘é€çš„æ¶ˆæ¯æ•°æ®ã€‚

### è¿”å›å€¼
- `void`

---

## broadcast(event, data, localOnly)

### æè¿°
å‘æ‰€æœ‰å·²è¿æ¥çš„ WebSocket å®¢æˆ·ç«¯å¹¿æ’­æ¶ˆæ¯ã€‚  
- å¦‚æœ `localOnly` ä¸º `true`ï¼Œä»…å¹¿æ’­åˆ°æœ¬åœ°å®¢æˆ·ç«¯ã€‚  
- å¦‚æœ `localOnly` ä¸º `false` æˆ–æœªæä¾›ï¼Œæ¶ˆæ¯åŒæ—¶å‘å¸ƒåˆ° Redisï¼Œå®ç°è·¨æœåŠ¡å™¨å¹¿æ’­ã€‚  
- å½“ WebSocket æœåŠ¡å…³é—­æ—¶ï¼Œæ“ä½œè·³è¿‡ã€‚

### å‚æ•°
- `event` {string} - è¦å¹¿æ’­çš„äº‹ä»¶åç§°ã€‚
- `data` {Object} - è¦å¹¿æ’­çš„æ¶ˆæ¯æ•°æ®ã€‚
- `localOnly` {boolean} [å¯é€‰] - æ˜¯å¦åªå¹¿æ’­åˆ°æœ¬åœ°ï¼Œé»˜è®¤å€¼ä¸º `false`ã€‚

### è¿”å›å€¼
- `void`

---

## joinRoom(roomNamespace, roomId, socketId)

### æè¿°  
å°†æŒ‡å®šçš„ socketId æ·»åŠ åˆ°ç‰¹å®šæˆ¿é—´ï¼Œç®¡ç†æœ¬åœ°æˆå‘˜å…³ç³»ï¼Œå¹¶é€šè¿‡ Redis è®¢é˜…æˆ¿é—´å‘½ä»¤ç©ºé—´ã€‚

- å‚æ•° `roomNamespace` ç”¨äºå®šä¹‰æˆ¿é—´çš„ç²’åº¦å’Œç±»åˆ«ï¼Œå¼€å‘è€…å¯ä»¥è‡ªç”±æ§åˆ¶å‘½åè§„åˆ™ï¼Œä¾‹å¦‚ä½¿ç”¨ç±»ä¼¼ `app:chat:game:hot` çš„å±‚çº§å‘½åæ¥è¡¨ç¤ºä¸åŒå±‚çº§æˆ–ç±»å‹çš„æˆ¿é—´ã€‚  
- **æ³¨æ„ï¼š** ä¸ºäº†ç¡®ä¿æœ¬åœ°æœåŠ¡å™¨ä¸­è¯¥æˆ¿é—´çš„å®¢æˆ·ç«¯èƒ½å¤Ÿæ¥æ”¶æ¶ˆæ¯ï¼ŒæœåŠ¡å™¨ **å¿…é¡»è®¢é˜…** å¯¹åº”çš„ `roomNamespace` Redis é¢‘é“ã€‚  
- å»ºè®®å¼€å‘è€…åœ¨é€‚é…å™¨æ„é€ å‡½æ•°çš„ `presetRoomNamespaces` ä¸­é¢„å…ˆè®¢é˜…è¿™äº›é¢‘é“ï¼Œæˆ–ä¾èµ–æœ¬æ–¹æ³•å†…ç½®çš„è‡ªåŠ¨è®¢é˜…é€»è¾‘ã€‚  
- è®¢é˜…æ“ä½œå†…éƒ¨ä¼šæ£€æŸ¥ï¼Œé¿å…é‡å¤è®¢é˜…ã€‚

### å‚æ•°  
- `roomNamespace` {string} - æˆ¿é—´å‘½åç©ºé—´ï¼Œæ§åˆ¶æˆ¿é—´ç±»åˆ«å’Œç²’åº¦ï¼Œå¦‚ `app:chat`ã€`game:hot` ç­‰ï¼Œå‘½åç»“æ„ç”±å¼€å‘è€…è‡ªç”±å®šä¹‰ã€‚**å¿…é¡»è®¢é˜…æ­¤é¢‘é“ï¼Œæœ¬åœ°å®¢æˆ·ç«¯æ‰èƒ½æ¥æ”¶æ¶ˆæ¯ã€‚**  
- `roomId` {string} - æˆ¿é—´åœ¨å‘½åç©ºé—´ä¸‹çš„å”¯ä¸€æ ‡è¯†ç¬¦ã€‚  
- `socketId` {string} - éœ€è¦åŠ å…¥æˆ¿é—´çš„ç©å®¶ socketIdã€‚

### è¿”å›å€¼  
- `void`

---

## leaveRoom(roomNamespace, roomId, socketId)

### æè¿°  
å°†æŒ‡å®šçš„ socketId ä»ç‰¹å®šæˆ¿é—´ç§»é™¤ï¼Œå¹¶æ›´æ–°æœ¬åœ°æˆå‘˜æ•°æ®ç»“æ„ã€‚

- `roomNamespace` æ˜¯æˆ¿é—´çš„å‘½åç©ºé—´ã€‚  
- å½“å‘½åç©ºé—´ä¸‹çš„æŸä¸ªæˆ¿é—´ä¸ºç©ºæ—¶ï¼Œè¯¥æˆ¿é—´å°†è¢«åˆ é™¤ã€‚  
- å½“è¯¥å‘½åç©ºé—´ä¸‹ä¸å†æœ‰ä»»ä½•æˆ¿é—´æ—¶ï¼Œå‘½åç©ºé—´ä¹Ÿä¼šè¢«åˆ é™¤ã€‚  
- æœåŠ¡å™¨ä¼šæ ¹æ®é€‚é…å™¨æ„é€ å‡½æ•°ä¸­çš„ `autoUnsubscribe` é…ç½®ï¼Œå†³å®šæ˜¯å¦è‡ªåŠ¨å–æ¶ˆè®¢é˜…å¯¹åº”çš„ Redis é¢‘é“ï¼Œä»è€Œå‡å°‘ä¸å¿…è¦çš„æ¶ˆæ¯æ¥æ”¶ã€‚  
- åŒæ—¶æ›´æ–°æœ¬åœ° socketId åˆ°æˆ¿é—´çš„æ˜ å°„å…³ç³»ï¼Œä¿æŒå†…éƒ¨çŠ¶æ€ä¸€è‡´ã€‚

### å‚æ•°  
- `roomNamespace` {string} - è¦ç§»é™¤ socketId çš„æˆ¿é—´å‘½åç©ºé—´ã€‚  
- `roomId` {string} - è¦é€€å‡ºçš„æˆ¿é—´å”¯ä¸€æ ‡è¯†ç¬¦ã€‚  
- `socketId` {string} - é€€å‡ºæˆ¿é—´çš„ç©å®¶ socketIdã€‚

### è¿”å›å€¼  
- `void`


---

## removeRoom(roomNamespace, roomId)

### æè¿°
å½»åº•åˆ é™¤æŒ‡å®šæˆ¿é—´ï¼Œå¹¶æ¸…ç†æ‰€æœ‰ä¸è¯¥æˆ¿é—´ç›¸å…³çš„ socketId æ˜ å°„ã€‚

è¯¥æ–¹æ³•ä¼šï¼š  
- ä»æŒ‡å®šæˆ¿é—´ç§»é™¤æ‰€æœ‰è¿æ¥çš„ socketIdã€‚  
- æ¸…ç†æ¯ä¸ª socketId åœ¨å¯¹åº” roomNamespace ä¸‹çš„æˆ¿é—´æ˜ å°„ã€‚  
- åˆ é™¤å…¨å±€æˆ¿é—´æ˜ å°„ä¸­çš„è¯¥æˆ¿é—´è®°å½•ã€‚  
- å¦‚æœç§»é™¤åè¯¥ roomNamespace ä¸ºç©ºï¼Œä¹Ÿä¼šå°†å…¶åˆ é™¤ã€‚

**æ³¨æ„ï¼š**  
- å½“ä½ æƒ³å½»åº•åˆ é™¤æˆ¿é—´åŠå…¶ç›¸å…³å¼•ç”¨æ—¶ä½¿ç”¨æœ¬æ–¹æ³•ã€‚

### å‚æ•°
- `roomNamespace {string}`ï¼šæˆ¿é—´å‘½åç©ºé—´ï¼ˆç±»å‹/ç±»åˆ«ï¼‰ã€‚  
- `roomId {string}`ï¼šè¦åˆ é™¤çš„æˆ¿é—´å”¯ä¸€æ ‡è¯†ã€‚

### è¿”å›å€¼
- `void`

---

## getSocketCountInRoom(roomNamespace, roomId, options)

### æè¿°
è·å–æŒ‡å®šæˆ¿é—´æˆ–æˆ¿é—´ç±»å‹ï¼ˆå‘½åç©ºé—´ï¼‰ä¸­çš„ç”¨æˆ·æ•°é‡ã€‚

- å¦‚æœæä¾›äº† `roomId`ï¼Œåˆ™ç»Ÿè®¡è¯¥æˆ¿é—´å†…çš„ç”¨æˆ·æ•°é‡ã€‚  
- å¦‚æœæœªæä¾› `roomId`ï¼Œåˆ™ç»Ÿè®¡è¯¥å‘½åç©ºé—´ä¸‹æ‰€æœ‰æˆ¿é—´çš„ç”¨æˆ·æ€»æ•°ã€‚  
- æ”¯æŒç²¾ç¡®åŒ¹é…å’Œæ¨¡ç³ŠåŒ¹é…ï¼ˆæ ¹æ® roomId å‰ç¼€ï¼‰ã€‚

### å‚æ•°
- `roomNamespace {string}`ï¼šæˆ¿é—´å‘½åç©ºé—´ï¼ˆå¦‚ 'chat'ã€'gameRoom'ï¼‰ã€‚  
- `roomId {string} [å¯é€‰]`ï¼šæŒ‡å®šçš„æˆ¿é—´ IDã€‚  
- `options {Object} [å¯é€‰]`ï¼šåŒ¹é…é€‰é¡¹ã€‚  
  - `exactMatch {boolean} [é»˜è®¤ true]`ï¼šæ˜¯å¦è¿›è¡Œç²¾ç¡®åŒ¹é…ï¼ˆtrueï¼‰æˆ–æ¨¡ç³ŠåŒ¹é…ï¼ˆfalseï¼Œå‰ç¼€åŒ¹é…ï¼‰ã€‚

### è¿”å›å€¼
- `number`ï¼šåŒ¹é…æˆ¿é—´å†…çš„ç”¨æˆ·æ•°é‡ã€‚

---

## getRoomSocketIds(roomNamespace, roomId, options)

### æè¿°
è·å–æŒ‡å®šæˆ¿é—´ç±»å‹ï¼ˆå‘½åç©ºé—´ï¼‰ä¸‹æ‰€æœ‰åŒ¹é…æˆ¿é—´çš„ socketId é›†åˆã€‚

- å¦‚æœæä¾›äº† `roomId`ï¼Œåˆ™è¿”å›ç²¾ç¡®æˆ–æ¨¡ç³ŠåŒ¹é…æˆ¿é—´å†…çš„æ‰€æœ‰ socketIdã€‚  
- å¦‚æœæœªæä¾› `roomId`ï¼Œåˆ™è¿”å›è¯¥å‘½åç©ºé—´ä¸‹æ‰€æœ‰æˆ¿é—´çš„æ‰€æœ‰ socketIdã€‚

### å‚æ•°
- `roomNamespace {string}`ï¼šè¦æŸ¥è¯¢çš„æˆ¿é—´ç±»å‹åç§°ã€‚  
- `roomId {string|null} [å¯é€‰]`ï¼šè¿‡æ»¤ç”¨çš„æˆ¿é—´ IDã€‚  
- `options {Object} [å¯é€‰]`ï¼šé…ç½®é€‰é¡¹ã€‚  
  - `exactMatch {boolean} [é»˜è®¤ true]`ï¼šæ˜¯å¦ä½¿ç”¨ç²¾ç¡®åŒ¹é…æˆ–æ¨¡ç³ŠåŒ¹é…ã€‚

### è¿”å›å€¼
- `Set<string>`ï¼šåŒ¹é…æˆ¿é—´å†…çš„æ‰€æœ‰ socketId é›†åˆã€‚

---

## getJoinedRooms(socketId, roomNamespace)

### æè¿°
è·å–æŒ‡å®š socketId åŠ å…¥çš„æˆ¿é—´åˆ—è¡¨ï¼Œå¯æŒ‰æˆ¿é—´å‘½åç©ºé—´å‰ç¼€è¿‡æ»¤ã€‚

- è¿”å›ä¸€ä¸ª Mapï¼Œé”®ä¸ºæˆ¿é—´å‘½åç©ºé—´ï¼Œå€¼ä¸ºè¯¥å‘½åç©ºé—´ä¸‹çš„æˆ¿é—´IDé›†åˆã€‚  
- å¦‚æœæä¾› `roomNamespace`ï¼Œåˆ™åªè¿”å›å‘½åç©ºé—´ä»¥è¯¥å‰ç¼€å¼€å¤´çš„æˆ¿é—´ã€‚

### å‚æ•°
- `socketId {string}`ï¼šè¦æŸ¥è¯¢çš„ socketIdã€‚  
- `roomNamespace {string|null} [å¯é€‰]`ï¼šæˆ¿é—´å‘½åç©ºé—´å‰ç¼€ï¼Œé»˜è®¤ null è¡¨ç¤ºä¸è¿‡æ»¤ã€‚

### è¿”å›å€¼
- `Map<string, Set<string>>`ï¼šsocketId åŠ å…¥çš„æˆ¿é—´å‘½åç©ºé—´ä¸å¯¹åº”æˆ¿é—´IDé›†åˆçš„æ˜ å°„ã€‚

---

## isJoinedRoom(socketId, roomNamespace, roomId)

### æè¿°
åˆ¤æ–­æŒ‡å®š socketId æ˜¯å¦åŠ å…¥äº†æŸä¸ªæˆ¿é—´æˆ–æŸç§æˆ¿é—´ç±»å‹ã€‚

- å¦‚æœæä¾›äº† `roomId`ï¼Œåˆ™åˆ¤æ–­æ˜¯å¦åŠ å…¥äº†è¯¥å…·ä½“æˆ¿é—´ã€‚  
- å¦‚æœæœªæä¾› `roomId`ï¼Œåˆ™åˆ¤æ–­æ˜¯å¦åŠ å…¥äº†è¯¥å‘½åç©ºé—´ä¸‹ä»»æ„æˆ¿é—´ã€‚

### å‚æ•°
- `socketId {string}`ï¼šè¦æ£€æµ‹çš„ socketIdã€‚  
- `roomNamespace {string}`ï¼šæˆ¿é—´å‘½åç©ºé—´ã€‚  
- `roomId {string} [å¯é€‰]`ï¼šå…·ä½“çš„æˆ¿é—´ IDï¼ˆå¯é€‰ï¼‰ã€‚

### è¿”å›å€¼
- `boolean`ï¼šå¦‚æœåŠ å…¥äº†å¯¹åº”çš„æˆ¿é—´æˆ–å‘½åç©ºé—´è¿”å› `true`ï¼Œå¦åˆ™è¿”å› `false`ã€‚

---

## getRoomCount(roomNamespace, options)

### æè¿°
è·å–æŒ‡å®šå‘½åç©ºé—´ä¸‹çš„æˆ¿é—´æ•°é‡ã€‚

- å¦‚æœ `options.exactMatch` ä¸º `true`ï¼Œåˆ™åªç»Ÿè®¡ä¸ `roomNamespace` å®Œå…¨åŒ¹é…çš„æˆ¿é—´æ•°é‡ã€‚  
- å¦‚æœä¸º `false`ï¼Œåˆ™ç»Ÿè®¡æ‰€æœ‰ä»¥ `roomNamespace` å¼€å¤´çš„å‘½åç©ºé—´ä¸‹çš„æˆ¿é—´æ•°é‡ã€‚

### å‚æ•°
- `roomNamespace {string}`ï¼šæˆ¿é—´å‘½åç©ºé—´å‰ç¼€ã€‚  
- `options {object}`ï¼šåŒ¹é…é€‰é¡¹ã€‚  
  - `exactMatch {boolean}`ï¼šæ˜¯å¦è¿›è¡Œç²¾ç¡®åŒ¹é…ï¼Œé»˜è®¤ `true`ã€‚

### è¿”å›å€¼
- `{number}`ï¼šåŒ¹é…åˆ°çš„æˆ¿é—´æ•°é‡ã€‚

---

## getRoomIds(roomNamespace, options)

### æè¿°
è·å–æŒ‡å®šå‘½åç©ºé—´ä¸‹çš„æˆ¿é—´ ID åˆ—è¡¨ã€‚

- å¦‚æœ `options.exactMatch` ä¸º `true`ï¼Œåˆ™åªè¿”å›ä¸ `roomNamespace` å®Œå…¨åŒ¹é…çš„æˆ¿é—´ IDã€‚  
- å¦‚æœä¸º `false`ï¼Œåˆ™è¿”å›æ‰€æœ‰ä»¥ `roomNamespace` å¼€å¤´çš„å‘½åç©ºé—´ä¸‹çš„æˆ¿é—´ IDã€‚

### å‚æ•°
- `roomNamespace {string}`ï¼šæˆ¿é—´å‘½åç©ºé—´å‰ç¼€ã€‚  
- `options {object}`ï¼šåŒ¹é…é€‰é¡¹ã€‚  
  - `exactMatch {boolean}`ï¼šæ˜¯å¦è¿›è¡Œç²¾ç¡®åŒ¹é…ï¼Œé»˜è®¤ `true`ã€‚

### è¿”å›å€¼
- `{string[]}`ï¼šç¬¦åˆæ¡ä»¶çš„æˆ¿é—´ ID æ•°ç»„ã€‚

---

## setUserSocket(socketId, socket)

### æè¿°
æ·»åŠ ç”¨æˆ· socket æ˜ å°„å…³ç³»ã€‚

**é‡è¦è¯´æ˜ï¼š**  
å®¢æˆ·ç«¯æ¶ˆæ¯å‘é€ä¸»è¦ä¾èµ–äº `socketId` åˆ° `socket` çš„æ˜ å°„å…³ç³»ã€‚  
è¯·åŠ¡å¿…åœ¨ WebSocket è¿æ¥å»ºç«‹æˆ–åè®®å‡çº§å®Œæˆåï¼Œå®Œæˆç”¨æˆ·é‰´æƒï¼Œç„¶åè°ƒç”¨æ­¤æ–¹æ³•è®¾ç½®ç”¨æˆ· `socketId` ä¸ `socket` å®ä¾‹çš„æ˜ å°„ã€‚  
ç›¸åº”åœ°ï¼Œå½“å®¢æˆ·ç«¯æ–­å¼€è¿æ¥æ—¶ï¼Œåº”åŠæ—¶è°ƒç”¨ç§»é™¤æ˜ å°„çš„æ–¹æ³•ï¼Œæ¸…ç†å¯¹åº”çš„ `socketId` åˆ° `socket` çš„æ˜ å°„å®ä¾‹ï¼Œé¿å…èµ„æºæ³„æ¼å’ŒçŠ¶æ€æ··ä¹±ã€‚  

`socketId` å¿…é¡»æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œå¹¶ä¸”åœ¨æ‰€æœ‰æœåŠ¡å™¨èŠ‚ç‚¹ä¸­å”¯ä¸€ï¼Œæ¯”å¦‚ç”¨æˆ·çš„å”¯ä¸€ IDã€‚  
ç”±äºé€‚é…å™¨å†…éƒ¨ä½¿ç”¨ `Set()` å­˜å‚¨ socketId æ˜ å°„ï¼Œå³ä½¿æ•°å€¼ç›¸åŒçš„æ•°å­—ç±»å‹ socketId ä¹Ÿä¼šè¢«è§†ä½œä¸åŒé”®ï¼Œå¯¼è‡´é‡å¤å’Œé”™è¯¯ã€‚  
å› æ­¤ï¼Œå¦‚æœä½¿ç”¨æ•°å­—ç±»å‹ IDï¼Œå¿…é¡»å…ˆè½¬æ¢æˆå­—ç¬¦ä¸²å†ä¼ å…¥ï¼Œä»¥ä¿è¯æ˜ å°„çš„å”¯ä¸€æ€§å’Œæ­£ç¡®æ€§ã€‚
**æœ¬ç±»ä¸­æ‰€æœ‰çš„ socketId éƒ½éµå¾ªæ­¤çº¦å®šã€‚**

### å‚æ•°
- `socketId {string}`ï¼šç”¨æˆ·çš„ socket IDï¼ˆä¸èƒ½ä¸ºç©ºå­—ç¬¦ä¸²ï¼‰ã€‚
- `socket {Object}`ï¼šWebSocket è¿æ¥å¯¹è±¡ã€‚

### æŠ›å‡º
- å¦‚æœ `socketId` ä¸æ˜¯å­—ç¬¦ä¸²æˆ–è€… `socket` æ— æ•ˆï¼ŒæŠ›å‡ºé”™è¯¯ã€‚

---

## removeUserSocket(socketId)

### æè¿°
ç§»é™¤ç”¨æˆ· socket æ˜ å°„ï¼ŒåŒæ—¶æ¸…ç†ç›¸å…³çš„æˆ¿é—´æ˜ å°„å…³ç³»ã€‚
è¯¥æ–¹æ³•åº”åœ¨å®¢æˆ·ç«¯æ–­å¼€è¿æ¥æ—¶è°ƒç”¨ï¼Œä»¥æ­£ç¡®æ¸…é™¤ socketId åˆ° socket çš„æ˜ å°„åŠç›¸å…³èµ„æºã€‚
### å‚æ•°
- `socketId {string}`ï¼šç”¨æˆ·çš„ socket IDï¼ˆä¸èƒ½ä¸ºç©ºå­—ç¬¦ä¸²ï¼‰ã€‚

### æŠ›å‡º
- å¦‚æœ `socketId` ä¸æ˜¯å­—ç¬¦ä¸²ï¼ŒæŠ›å‡º `TypeError`ã€‚

---

## getSocketInstance(socketId)

### æè¿°
è·å–æŒ‡å®š socket ID å¯¹åº”çš„ WebSocket å®ä¾‹ã€‚

### å‚æ•°
- `socketId {string}`ï¼šç”¨æˆ·çš„ socket IDï¼ˆä¸èƒ½ä¸ºç©ºå­—ç¬¦ä¸²ï¼‰ã€‚

### è¿”å›å€¼
- `WebSocket|null`ï¼šæ‰¾åˆ°è¿”å›å¯¹åº” WebSocket å®ä¾‹ï¼Œå¦åˆ™è¿”å› nullã€‚

### æŠ›å‡º
- å¦‚æœ `socketId` ä¸æ˜¯å­—ç¬¦ä¸²ï¼ŒæŠ›å‡º `TypeError`ã€‚

---

## getSocketClientCount()

### æè¿°
è·å–å½“å‰æœåŠ¡å™¨èŠ‚ç‚¹è¿æ¥çš„å®¢æˆ·ç«¯æ€»æ•°ã€‚

### è¿”å›å€¼
- `number`ï¼šå½“å‰å®¢æˆ·ç«¯è¿æ¥æ•°ã€‚

---

## getServerName()

### æè¿°  
è·å–å½“å‰æœåŠ¡å™¨åç§°ã€‚

### å‚æ•°  
æ— 

### è¿”å›å€¼  
- `string`: å½“å‰æœåŠ¡å™¨åç§°ã€‚

---

## getWss()

### æè¿°  
è·å– WebSocket æœåŠ¡å™¨å®ä¾‹ã€‚

### å‚æ•°  
æ— 

### è¿”å›å€¼  
- `WebSocket.Server | null`: è¿”å› WebSocket æœåŠ¡å™¨å®ä¾‹ï¼ˆå¦‚æœå·²åˆå§‹åŒ–ï¼‰ï¼Œå¦åˆ™è¿”å› nullã€‚

---

### parseWsRequestParams(req, options)

### æè¿°  
è§£æ WebSocket è¯·æ±‚ä¸­çš„ URL å‚æ•°ã€‚

- è§£æè¯·æ±‚ URL ä¸­çš„æŸ¥è¯¢å‚æ•°ã€‚  
- æ”¯æŒé€‰é¡¹æ§åˆ¶è§£æè¡Œä¸ºï¼Œå¦‚å‚æ•°é”®æ˜¯å¦è½¬å°å†™ï¼Œæ˜¯å¦æå–è·¯å¾„ç­‰ã€‚  
- **æ³¨æ„ï¼š** æœ¬è§£æä¾èµ–å®¢æˆ·ç«¯ä½¿ç”¨ `WebSocketConnector` ç±»ï¼Œä¸”æŒ‰çº¦å®šä¼ å…¥å‚æ•°ï¼Œå¦åˆ™è§£æç»“æœå¯èƒ½ä¸å®Œæ•´æˆ–ä¸å‡†ç¡®ã€‚

### å‚æ•°  
- `req {object}`: WebSocket è¯·æ±‚å¯¹è±¡ã€‚  
- `options {object} [å¯é€‰]`: è§£æé€‰é¡¹ã€‚  
  - `autoLowerCaseKeys {boolean} [é»˜è®¤=false]`: æ˜¯å¦è‡ªåŠ¨å°†å‚æ•°é”®è½¬æ¢ä¸ºå°å†™ã€‚  
  - `parsePath {boolean} [é»˜è®¤=true]`: æ˜¯å¦è§£æå¹¶è¿”å›è¯·æ±‚è·¯å¾„ã€‚  
  - `autoRemoveLeadingSlash {boolean} [é»˜è®¤=true]`: æ˜¯å¦è‡ªåŠ¨å»é™¤è·¯å¾„å¼€å¤´çš„æ–œæ ã€‚

### è¿”å›å€¼  
- `{object}` è§£æç»“æœå¯¹è±¡ï¼ŒåŒ…å«ï¼š  
  - `params {object}`: è§£æåçš„ URL æŸ¥è¯¢å‚æ•°ã€‚  
  - `path {string|null}`: è§£æåçš„ URL è·¯å¾„ï¼Œå»é™¤å¼€å¤´æ–œæ ï¼ˆå¦‚æœå¯ç”¨ï¼‰ã€‚ç¤ºä¾‹ï¼šurl å¦‚ `ws://localhost:8080/chat`ï¼Œå¯ä»¥æå–è·¯å¾„éƒ¨åˆ† `chat` çš„å€¼ã€‚

---

# WebSocketConnector

## constructor(options)

### æè¿°  
åˆå§‹åŒ– WebSocket å®¢æˆ·ç«¯å®ä¾‹ï¼Œå…è®¸ç”¨æˆ·ä¼ å…¥è‡ªå®šä¹‰é…ç½®é¡¹ã€‚

### å‚æ•°  
- options {Object}: é…ç½®é¡¹å¯¹è±¡  
  - url {string}: WebSocket è¿æ¥åœ°å€ï¼Œå¿…é¡»ä»¥ `ws://` æˆ– `wss://` å¼€å¤´ï¼Œä¾‹å¦‚ `ws://127.0.0.1:8081`  
  - pingInterval {number}: ping å¿ƒè·³çš„å‘é€é—´éš”æ—¶é—´ï¼Œå•ä½ä¸ºæ¯«ç§’ï¼Œé»˜è®¤å€¼ä¸º `10000`  
  - pongTimeout {number}: å‘é€ ping åç­‰å¾… pong çš„è¶…æ—¶æ—¶é—´ï¼Œé»˜è®¤å€¼ä¸º `2000` æ¯«ç§’ï¼Œè¶…æ—¶è§†ä¸ºæ–­è¿   
  - fastReconnectThreshold {number}: å¿«é€Ÿé‡è¿æœ€å¤§å°è¯•æ¬¡æ•°ï¼Œé»˜è®¤ `3` æ¬¡  
  - fastReconnectInterval {number}: å¿«é€Ÿé‡è¿çš„é—´éš”æ—¶é—´ï¼Œé»˜è®¤ `3000` æ¯«ç§’  
  - reconnectMaxInterval {number}: æœ€å¤§é‡è¿é—´éš”æ—¶é—´ï¼Œé»˜è®¤ `120_000` æ¯«ç§’ï¼Œå³ 120 ç§’
  - pingMsg {string}: ping æ¶ˆæ¯ä½“å†…å®¹ï¼Œé»˜è®¤ä¸ºç©ºå­—ç¬¦ä¸²  
  - callbackTimeout {number}: å›è°ƒæˆ– Promise å“åº”çš„æœ€å¤§ç­‰å¾…æ—¶é—´ï¼Œé»˜è®¤ `5000` æ¯«ç§’  
  - repeatLimit {number|null}: æœ€å¤§é‡è¿æ¬¡æ•°ï¼Œé»˜è®¤æ— é™åˆ¶ï¼ˆ`null` è¡¨ç¤ºæ— é™ï¼‰  
  - pendingTimeout {number}: è§¦å‘ pending å›è°ƒçš„ç­‰å¾…æ—¶é—´ï¼Œé»˜è®¤ `100` æ¯«ç§’ï¼Œåº”å°äº callbackTimeout   
  - customParams {Object}: è‡ªå®šä¹‰é¢å¤–å‚æ•°å¯¹è±¡ï¼ŒåŒ…å«è¦ä¼ é€’çš„é”®å€¼å¯¹

### ç¤ºä¾‹
  ```js
  const client = new WebSocketConnector({
    url: 'ws://localhost:9000/chat',
    customParams: {
      name: 'sam',
      id: 888
    }
  });
  ```
---

## on(event, listener, tag)

### æè¿°  
æ³¨å†Œä¸€ä¸ªäº‹ä»¶ç›‘å¬å™¨ï¼Œå½“æŒ‡å®šäº‹ä»¶è¢«è§¦å‘æ—¶æ‰§è¡Œå¯¹åº”å›è°ƒå‡½æ•°ã€‚

### å‚æ•°  
- event {string}: è¦ç›‘å¬çš„äº‹ä»¶åç§°  
- listener {function}: äº‹ä»¶è§¦å‘æ—¶è¦æ‰§è¡Œçš„å›è°ƒå‡½æ•°  
- tag {string|number} [å¯é€‰]: è‡ªå®šä¹‰æ ‡ç­¾ï¼Œç”¨äºåç»­ç§»é™¤ç›‘å¬å™¨æ—¶æ ‡è¯†

## è¿”å›å€¼
- `void`

---

## once(event, listener, tag)

### æè¿°  
æ³¨å†Œä¸€ä¸ªä¸€æ¬¡æ€§äº‹ä»¶ç›‘å¬å™¨ï¼Œè¯¥ç›‘å¬å™¨åªä¼šåœ¨äº‹ä»¶é¦–æ¬¡è§¦å‘æ—¶æ‰§è¡Œä¸€æ¬¡ï¼Œä¹‹åä¼šè¢«è‡ªåŠ¨ç§»é™¤ã€‚

### å‚æ•°  
- event {string}: è¦ç›‘å¬çš„äº‹ä»¶åç§°  
- listener {function}: äº‹ä»¶é¦–æ¬¡è§¦å‘æ—¶è¦æ‰§è¡Œçš„å›è°ƒå‡½æ•°  
- tag {string|number} [å¯é€‰]: è‡ªå®šä¹‰æ ‡ç­¾ï¼Œç”¨äºåç»­ç§»é™¤ç›‘å¬å™¨æ—¶æ ‡è¯†

## è¿”å›å€¼
- `void`

---

## off(event, listenerOrTag)

### æè¿°  
ç§»é™¤å·²æ³¨å†Œçš„äº‹ä»¶ç›‘å¬å™¨ï¼Œä½¿å…¶ä¸å†å“åº”æŒ‡å®šäº‹ä»¶ã€‚

- å¦‚æœ `listenerOrTag` æ˜¯å‡½æ•°ï¼Œåˆ™ç§»é™¤å¯¹åº”çš„å›è°ƒå‡½æ•°ç›‘å¬å™¨ã€‚  
- å¦‚æœ `listenerOrTag` æ˜¯å­—ç¬¦ä¸²æˆ–æ•°å­—ï¼Œåˆ™ç§»é™¤å¸¦æœ‰å¯¹åº”æ ‡ç­¾çš„ç›‘å¬å™¨ã€‚  
- å¦‚æœä¸ä¼  `listenerOrTag`ï¼Œåˆ™åˆ é™¤è¯¥äº‹ä»¶ä¸‹æ‰€æœ‰ç›‘å¬å™¨ã€‚

### å‚æ•°  
- event {string}: è¦ç§»é™¤ç›‘å¬å™¨çš„äº‹ä»¶åç§°  
- listenerOrTag {function|string|number} [å¯é€‰]: è¦ç§»é™¤çš„ç›‘å¬å‡½æ•°æˆ–æ ‡ç­¾

## è¿”å›å€¼
- `void`

---

## emit(event, data, callback, options)

### æè¿°  
å‘ WebSocket æœåŠ¡å™¨å‘é€äº‹ä»¶å’Œæ•°æ®ï¼Œæ”¯æŒå“åº”å›è°ƒä¸â€œç­‰å¾…ä¸­â€å¤„ç†æœºåˆ¶ã€‚

åœ¨å‘é€å‰ä¼šæ£€æŸ¥ WebSocket æ˜¯å¦å·²è¿æ¥ã€‚  
å¦‚æœæä¾›äº†å›è°ƒå‡½æ•°ï¼Œåˆ™ä¼šç”Ÿæˆå”¯ä¸€çš„å›è°ƒ ID å¹¶é™„åŠ åˆ°å‘é€æ•°æ®ä¸­ï¼ŒåŒæ—¶æ³¨å†Œè¯¥å›è°ƒå‡½æ•°ã€‚  
è¿˜å¯ä»¥é…ç½®å¯é€‰çš„ pending å¤„ç†é€»è¾‘ï¼Œç”¨äºå“åº”å»¶è¿Ÿæ—¶è§¦å‘ç­‰å¾…æç¤ºã€‚

### å‚æ•°  
- event {string}: è¦å‘é€çš„äº‹ä»¶åç§°ã€‚  
- data {Object}: è¦éšäº‹ä»¶å‘é€çš„æ•°æ®å¯¹è±¡ã€‚  
- callback {function} (å¯é€‰): ç”¨äºæ¥æ”¶æœåŠ¡å™¨å“åº”çš„å›è°ƒå‡½æ•°ã€‚  
- options {Object} (å¯é€‰): å›è°ƒè¡Œä¸ºçš„é™„åŠ é…ç½®é¡¹ã€‚  
  - options.callbackTimeout {number} (å¯é€‰): å›è°ƒå‡½æ•°çš„è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ã€‚  
  - options.onPending {function} (å¯é€‰): å½“å“åº”è¶…å‡º pendingTimeout æ—¶è§¦å‘çš„å‡½æ•°ã€‚  
  - options.pendingTimeout {number} (å¯é€‰): è§¦å‘ `onPending` çš„ç­‰å¾…æ—¶é•¿ï¼ˆæ¯«ç§’ï¼‰ã€‚

## è¿”å›å€¼
- `void`

### ç¤ºä¾‹

  ```js
  // å‘æœåŠ¡å™¨å‘é€ 'say' äº‹ä»¶ï¼Œæºå¸¦æ¶ˆæ¯å†…å®¹ï¼Œ
  // åŒæ—¶ä¼ å…¥ä¸€ä¸ªå›è°ƒå‡½æ•°ç”¨äºå¤„ç†ç»“æœæˆ–é”™è¯¯ï¼Œ
  // ä»¥åŠä¸€ä¸ªå¯é€‰çš„ onPending å›è°ƒï¼Œç”¨äºå“åº”å»¶è¿Ÿæ—¶çš„æç¤ºã€‚

  client.emit('say', { msg: 'Hi server' }, (err, data) => { 
    if (err) { 
      console.error('Received error:', err);
    } else {
      console.log('Received response:', data);
    }
  }, {
    onPending: () => { 
      console.log('Pending... waiting for response');
    }
  });

  // err å¯¹è±¡ç»“æ„ç¤ºä¾‹ï¼š
  // {
  //   error: 'WebSocket is not open',      // é”™è¯¯æè¿°å­—ç¬¦ä¸²
  //   errorCode: 'WS_NOT_OPEN'              // é”™è¯¯ä»£ç ï¼Œç”¨äºç¨‹åºåˆ¤æ–­
  // }
  // æˆ–è€…ï¼š
  // {
  //   error: `Is callback timeout: ${callbackId}`,  // å›è°ƒè¶…æ—¶é”™è¯¯æè¿°
  //   errorCode: 'CALLBACK_TIMEOUT'                   // è¶…æ—¶é”™è¯¯ä»£ç 
  // }
  ```
---

## emitWithPromise(event, data, options)

### æè¿°  
å‘ WebSocket æœåŠ¡å™¨å‘é€äº‹ä»¶æ•°æ®ï¼Œå¹¶è¿”å›ä¸€ä¸ª `Promise`ï¼Œç”¨äºå¤„ç†å“åº”æˆ–é”™è¯¯ä¿¡æ¯ã€‚

å¦‚æœè¿æ¥æ­£å¸¸ï¼Œä¼šç”Ÿæˆå”¯ä¸€çš„ `callbackId` å¹¶æ³¨å†Œå›è°ƒåå‘é€äº‹ä»¶ã€‚  
æ”¯æŒå“åº”è¶…æ—¶æ§åˆ¶åŠâ€œç­‰å¾…ä¸­â€å¤„ç†é€»è¾‘ã€‚  
è‹¥è¿æ¥ä¸å¯ç”¨ï¼Œ`Promise` ä¼šç«‹å³è¿”å›é”™è¯¯ç»“æœã€‚

### å‚æ•°  
- event {string}: è¦å‘é€çš„äº‹ä»¶åç§°ã€‚  
- data {Object}: äº‹ä»¶æºå¸¦çš„æ•°æ®å¯¹è±¡ã€‚  
- options {Object} (å¯é€‰): é™„åŠ é…ç½®é¡¹ã€‚  
  - options.onPending {function} (å¯é€‰): å¦‚æœå“åº”å»¶è¿Ÿï¼Œè¶…æ—¶å‰è§¦å‘çš„ç­‰å¾…å¤„ç†å‡½æ•°ã€‚  
  - options.pendingTimeout {number} (å¯é€‰): ç­‰å¾…å¤šä¹…è§¦å‘ `onPending`ï¼ˆå•ä½ï¼šæ¯«ç§’ï¼‰ã€‚  
  - options.callbackTimeout {number} (å¯é€‰): å“åº”çš„è¶…æ—¶æ—¶é—´ï¼ˆå•ä½ï¼šæ¯«ç§’ï¼‰ã€‚

### è¿”å›å€¼  
- `Promise<Object>`: è¿”å›ä¸€ä¸ª Promiseï¼Œè§£æä¸ºå“åº”æ•°æ®æˆ–é”™è¯¯ä¿¡æ¯ã€‚

### ç¤ºä¾‹

  ```js
  // å‘æœåŠ¡å™¨å‘é€ 'say' äº‹ä»¶ï¼Œé™„å¸¦æ¶ˆæ¯æ•°æ®ï¼Œ
  // å¹¶ä½¿ç”¨ Promise æ–¹å¼æ¥æ”¶ç»“æœï¼Œæ”¯æŒå“åº”å»¶è¿Ÿæç¤ºå›è°ƒ onPendingã€‚

  client.emitWithPromise('say', { msg: 'Hi server' }, {
    onPending: () => { 
      console.log('requesting...')
    }
  }).then((result) => {
    if (result.success) {
      console.log('Received response:', result.data);
    } else {
      console.error('Received error:', result.error, result.errorCode);
    }
  })

 
  // ä½¿ç”¨ async/await å‘æœåŠ¡å™¨å‘é€ 'say' äº‹ä»¶ï¼Œå¸¦æ¶ˆæ¯æ•°æ®å’Œå»¶è¿Ÿæç¤ºå›è°ƒï¼Œ
  // é”™è¯¯ä¸ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œè€Œæ˜¯é€šè¿‡ result.success ä¸º false è¡¨ç¤ºã€‚

  const result = await client.emitWithPromise('say', { msg: 'Hi server' }, {
    onPending: () => {
      // è¯·æ±‚å“åº”è¾ƒæ…¢æ—¶çš„å¤„ç†é€»è¾‘ï¼Œä¾‹å¦‚æç¤ºâ€œè¯·æ±‚ä¸­...â€
      console.log('requesting...');
    }
  });

  if (result.success) {
    // æˆåŠŸå“åº”å¤„ç†
    console.log('Received response:', result.data);
  } else {
    // å¤±è´¥å“åº”å¤„ç†ï¼ˆéå¼‚å¸¸ï¼Œä¸šåŠ¡å¤±è´¥ï¼‰ï¼Œä¾‹å¦‚è¶…æ—¶æˆ–å…¶ä»–é”™è¯¯
    console.error('Received error:', result.error, result.errorCode);
  }

  // errorCodeï¼šé”™è¯¯ä»£ç ï¼Œç”¨äºæ ‡è¯†é”™è¯¯ç±»å‹ï¼Œé”™è¯¯ä»£ç åŒ…æ‹¬ä½†ä¸é™äºä»¥ä¸‹å‡ ç§ï¼š
  // - 'WS_NOT_OPEN'      è¡¨ç¤º WebSocket è¿æ¥æœªæ‰“å¼€ã€‚
  // - 'CALLBACK_TIMEOUT' è¡¨ç¤ºå›è°ƒè¶…æ—¶ï¼Œæœªæ”¶åˆ°å“åº”ã€‚
  // errorï¼šå¯¹åº”çš„é”™è¯¯æè¿°å­—ç¬¦ä¸²ï¼Œç”¨äºè°ƒè¯•å’Œæ—¥å¿—è®°å½•ã€‚

  ```

---

## reconnect(repeatReset)

### æè¿°  
æ‰‹åŠ¨å¯åŠ¨ WebSocket é‡è¿æµç¨‹ã€‚

### å‚æ•°  
- repeatReset {boolean} (optional): æ˜¯å¦åœ¨é‡è¿å‰é‡ç½®å½“å‰é‡è¿æ¬¡æ•°ï¼Œé»˜è®¤ä¸ºfalse

## è¿”å›å€¼
- `void`

---


## reconnecting()

### æè¿°  
åˆ¤æ–­å½“å‰ WebSocket æ˜¯å¦å¤„äºè‡ªåŠ¨é‡è¿ä¸­ã€‚

è¯¥æ–¹æ³•é€šè¿‡æ£€æŸ¥å†…éƒ¨é‡è¿è®¡æ•°å™¨ `repeat`ï¼Œè‹¥å…¶å€¼å¤§äº 0ï¼Œåˆ™è¡¨ç¤ºæ­£åœ¨å°è¯•è‡ªåŠ¨é‡è¿ã€‚

### å‚æ•°  
æ— å‚æ•°

### è¿”å›å€¼  
- `boolean`: è‹¥ WebSocket æ­£åœ¨é‡è¿ï¼Œåˆ™è¿”å› `true`ï¼›å¦åˆ™è¿”å› `false`ã€‚

---

## setPingInterval(newInterval, immediate)

### æè¿°  
åŠ¨æ€è®¾ç½® WebSocket è¿æ¥çš„å¿ƒè·³ ping é—´éš”ã€‚  
å¯æ ¹æ®åº”ç”¨åœºæ™¯å®æ—¶è°ƒæ•´å¿ƒè·³é¢‘ç‡ï¼Œä¾‹å¦‚åœ¨ç”¨æˆ·åœç•™çš„æµè§ˆé¡µé¢ä¸­é™ä½é¢‘ç‡ï¼Œåœ¨äº¤äº’é¢‘ç¹çš„é¡µé¢ä¸­æé«˜é¢‘ç‡ã€‚

å¦‚æœ `immediate` ä¸º `true` ä¸”è¿æ¥å¤„äºæ´»åŠ¨çŠ¶æ€ï¼Œå°†ç«‹å³æ¸…é™¤å½“å‰çš„å®šæ—¶å™¨å¹¶ä½¿ç”¨æ–°çš„é—´éš”é‡å¯å¿ƒè·³æœºåˆ¶ã€‚

### å‚æ•°  
- `newInterval` {number}: æ–°çš„ ping é—´éš”æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ï¼Œå¿…é¡»ä¸ºæ­£æ•°ã€‚
- `immediate` {boolean}ï¼ˆå¯é€‰ï¼‰ï¼šæ˜¯å¦ç«‹å³ç”Ÿæ•ˆï¼Œé»˜è®¤ä¸º `false`ã€‚ä¸º `true` æ—¶ä¼šç«‹åˆ»é‡ç½®å¿ƒè·³è®¡æ—¶å™¨ã€‚

### è¿”å›å€¼  
- `void`

---

## getPingInterval()

### æè¿°  
è·å–å½“å‰ WebSocket è¿æ¥çš„å¿ƒè·³ ping é—´éš”æ—¶é—´ï¼ˆå•ä½ï¼šæ¯«ç§’ï¼‰ã€‚  
æ­¤æ–¹æ³•ç”¨äºæŸ¥çœ‹å½“å‰é…ç½®çš„å¿ƒè·³å‘¨æœŸï¼Œå¯ç”¨äºè°ƒè¯•æˆ–åŠ¨æ€åˆ¤æ–­æ˜¯å¦éœ€è¦è°ƒæ•´ã€‚

### å‚æ•°  
æ— 

### è¿”å›å€¼  
- `number`: å½“å‰é…ç½®çš„ ping é—´éš”æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰

---

## manualClose()

### æè¿°  
æ‰‹åŠ¨å…³é—­ WebSocket è¿æ¥ï¼Œå¹¶ç¦ç”¨è‡ªåŠ¨é‡è¿æœºåˆ¶ã€‚

è¯¥æ–¹æ³•ä¼šç¦ç”¨è‡ªåŠ¨é‡è¿ï¼Œæ¸…é™¤å¿ƒè·³å®šæ—¶å™¨ï¼Œå¹¶é‡Šæ”¾ WebSocket äº‹ä»¶å¼•ç”¨ï¼Œæœ‰åŠ©äºåŠ å¿«åƒåœ¾å›æ”¶ã€‚

### å‚æ•°  
æ— å‚æ•°

## è¿”å›å€¼
- `void`

---

# Events

---
## open
- è¿æ¥æˆåŠŸçš„æ—¶å€™è§¦å‘  
- å›è°ƒå‚æ•°(event)  
---
## close
  - å½“ WebSocket è¿æ¥å…³é—­æ—¶è§¦å‘ã€‚
  - å›è°ƒå‚æ•°(event) ï¼ˆåŒ…å«æ–­å¼€è¿æ¥çš„ code å’Œ reason è¯¦æƒ…ï¼‰

    ### é‡è¦è¯´æ˜ âš ï¸
    å®¢æˆ·ç«¯åœ¨æ”¶åˆ° close äº‹ä»¶å**ä¸ä¼šè‡ªåŠ¨é‡è¿**ã€‚  
    è¿™æ˜¯å› ä¸ºå¾ˆå¤šåœºæ™¯ä¸‹ï¼Œæ¯”å¦‚æœåŠ¡å™¨å¼ºåˆ¶è¸¢ä¸‹çº¿å®¢æˆ·ç«¯ï¼Œè‡ªåŠ¨é‡è¿æ˜¯ä¸åˆé€‚çš„ã€‚  
    å¦‚éœ€é‡è¿ï¼Œè¯·æ ¹æ®ä½ çš„ä¸šåŠ¡é€»è¾‘ï¼Œä¸»åŠ¨è°ƒç”¨ `reconnect()`ã€‚

    ### WebSocket å…³é—­ç ä½¿ç”¨è§„èŒƒ

    è¯·**ä¸è¦ä½¿ç”¨ WebSocket åè®®æœ¬èº«ä¿ç•™çš„å…³é—­ç **ã€‚  
    è¯¦ç»†è¯·å‚è§ [MDN WebSocket CloseEvent çŠ¶æ€ç ](https://developer.mozilla.org/en-US/docs/Web/API/CloseEvent/code)ã€‚

    ### è‡ªå®šä¹‰å…³é—­ç ï¼ˆâ‰¥ 4000ï¼‰

    4000 åŠä»¥ä¸Šçš„ä»£ç ä¿ç•™ç»™åº”ç”¨å±‚è‡ªå®šä¹‰ä½¿ç”¨ã€‚

    æˆ‘ä»¬çš„ `WebSocketConnector` ç±»å·²ç»å®šä¹‰äº†ä»¥ä¸‹å†…éƒ¨ä¿ç•™ç ï¼š

    | ä»£ç    | å«ä¹‰                        |
    |--------|-----------------------------|
    | 4001   | å®¢æˆ·ç«¯æ‰‹åŠ¨å…³é—­              |
    | 4002   | Pong è¶…æ—¶ï¼ˆå¿ƒè·³ä¸¢å¤±ï¼‰       |

    ä½ å¯ä»¥ä» 4010 å¼€å§‹ä½¿ç”¨å…¶ä»–è‡ªå®šä¹‰å…³é—­ç ï¼Œä¾‹å¦‚ï¼š

    | ä»£ç    | å«ä¹‰                        |
    |--------|-----------------------------|
    | 4010   | å¼ºåˆ¶ç™»å‡º                    |
    | 4011   | è®¤è¯å¤±è´¥                    |
    | 4012   | å¼‚åœ°ç™»å½•è¢«è¸¢                |

    ### æ€»ç»“

    - **ä¸è¦ä½¿ç”¨ WebSocket æ ‡å‡†å…³é—­ç ï¼ˆ< 4000ï¼‰ã€‚**  
    - **è¯·å°Šé‡å®¢æˆ·ç«¯ SDK ä¿ç•™çš„ 4001 å’Œ 4002 ä»£ç ã€‚**  
    - ä½¿ç”¨ â‰¥ 4010 çš„ä»£ç ä½œä¸ºä½ çš„è‡ªå®šä¹‰å…³é—­ç ä»¥é¿å…å†²çªã€‚

    ### ç¤ºä¾‹
    ```js
    client.on('close', (event) => {
      console.log(`å®¢æˆ·ç«¯å…³é—­è¿æ¥`, event.code, event.reason);

      // ä»¥ä¸‹æƒ…å†µä¸åº”é‡è¿ï¼š
      // 4001: å®¢æˆ·ç«¯æ‰‹åŠ¨å…³é—­
      // 4010, 4011, 4012: å¼ºåˆ¶ç™»å‡ºã€è®¤è¯å¤±è´¥ã€å¼‚åœ°ç™»å½•è¢«è¸¢
      if (
        event.code === 4001 ||
        event.code === 4010 ||
        event.code === 4011 ||
        event.code === 4012
      ) {
        console.log('è¿æ¥è¢«æ‰‹åŠ¨å…³é—­æˆ–å› å¼ºåˆ¶ç™»å‡º/è®¤è¯å¤±è´¥ç­‰åŸå› å…³é—­ï¼Œä¸è¿›è¡Œé‡è¿ã€‚');
        // å¯åœ¨æ­¤å¤„ç†æ¸…ç†æˆ–ç•Œé¢æç¤º
      } else {
        // å…¶ä»–æƒ…å†µï¼ˆå¦‚ pong è¶…æ—¶ 4002ï¼‰å°è¯•é‡è¿
        console.log('å°è¯•é‡æ–°è¿æ¥...');
        client.reconnect();
      }
    });

    // ç¤ºä¾‹ï¼šæœåŠ¡å™¨ç«¯å…³é—­å®¢æˆ·ç«¯è¿æ¥æ—¶å¯ä»¥è¿™æ ·ä¼ å…¥ code å’Œ reason
    // socket.close(4010, 'å¼ºåˆ¶ç™»å‡º');
    // å®¢æˆ·ç«¯å°†åœ¨ close äº‹ä»¶ä¸­è·å¾—è¯¥å…³é—­ç å’ŒåŸå› ï¼Œè¿›è¡Œç›¸åº”å¤„ç†ã€‚
    ```
---
## error
  - è¿æ¥å‡ºé”™çš„æ—¶å€™è§¦å‘  
  - å›è°ƒå‚æ•°(event)  
  - é»˜è®¤å°†ä¼šè§¦å‘è‡ªåŠ¨é‡è¿ï¼ˆé™¤éæ˜¾å¼è°ƒç”¨ `manualClose` å…³é—­è¿æ¥ï¼‰
---
## message
- æ¥æ”¶åˆ°æ¶ˆæ¯çš„æ—¶å€™è§¦å‘  
- å›è°ƒå‚æ•°(data)  
---
## ping
- å‘èµ· ping çš„æ—¶å€™è§¦å‘  
- æ— å›è°ƒå‚æ•°  
---
## pong
- æ¥æ”¶åˆ°æœåŠ¡å™¨ pong æ¶ˆæ¯çš„æ—¶å€™è§¦å‘  
- å›è°ƒå‚æ•°(speed)ï¼Œè¿”å›ä¸Šä¸€æ¬¡ ping è·ç¦»ç°åœ¨çš„æ—¶é—´å€¼ï¼ˆæ¯«ç§’ï¼‰ï¼Œç”¨äºæµ‹é‡ç½‘é€Ÿ 

  ### ç¤ºä¾‹
    ```js
    // ç›‘å¬ pong äº‹ä»¶ï¼Œè·å–æœåŠ¡å™¨å“åº”çš„å»¶è¿Ÿæ—¶é—´ï¼ˆå•ä½ï¼šæ¯«ç§’ï¼‰
    // è¿™ä¸ªå»¶è¿Ÿå¯ä»¥ç”¨æ¥æ˜¾ç¤ºç©å®¶çš„è¿æ¥çŠ¶æ€æˆ–ç½‘é€Ÿä¿¡å·å¼ºå¼±ï¼Œéå¸¸å®ç”¨ã€‚
    client.on('pong', (speed) => { 
      console.log(`Network latency: ${speed} ms`);
    })
    ```
---
## repeat-limit
- è¾¾åˆ°æœ€å¤§é‡è¿æ¬¡æ•°çš„æ—¶å€™è§¦å‘  
- å›è°ƒå‚æ•°(repeatLimit)ï¼Œæœ€å¤§é‡è¿æ¬¡æ•°  
---
## reconnect
- å‡†å¤‡é‡è¿çš„æ—¶å€™è§¦å‘  
- å›è°ƒå‚æ•°({repeatï¼Œtimeout})ï¼Œrepeat æ˜¯å½“å‰çš„é‡è¿æ¬¡æ•°ï¼Œtimeout æ˜¯å¤šä¹…åçœŸæ­£å‘èµ·é‡è¿ï¼ˆæ¯«ç§’ï¼‰  
---
## pong-timeout
- å‘èµ· ping ä¹‹ååœ¨è®¾å®šæ—¶é—´å†…æ²¡æœ‰æ”¶åˆ°æœåŠ¡å™¨ pong æ¶ˆæ¯æ—¶è§¦å‘  
- æ— å›è°ƒå‚æ•°  
